<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Housewarming Party - InviteGen</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50 border-b">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <a href="index.html" class="text-2xl hover:scale-110 transition-transform">üé®</a>
                    <div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-orange-500 to-orange-700 bg-clip-text text-transparent">
                            InviteGen
                        </h1>
                        <p class="text-xs text-gray-500">Housewarming Party</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button onclick="previewFullscreen()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition">
                        üëÅÔ∏è Preview
                    </button>
                    <button onclick="generateQR()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition">
                        üì± QR Code
                    </button>
                    <button onclick="publishProject()" class="px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-700 text-white rounded-lg text-sm font-medium hover:shadow-lg transition">
                        üöÄ Publish
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="flex h-[calc(100vh-73px)]">
        <!-- Left Panel - Editor -->
        <div class="w-full lg:w-5/12 bg-white border-r overflow-y-auto">
            <div class="p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Design Housewarming Invitation</h2>
                    <p class="text-sm text-gray-600 mt-1">Welcome friends to your new home</p>
                </div>

                <!-- Sections Container -->
                <div id="sectionsContainer" class="space-y-4">
                    <!-- Sections will be added here dynamically -->
                </div>

                <!-- Add Section Button -->
                <button onclick="openSectionModal()" class="w-full mt-6 py-4 border-2 border-dashed border-gray-300 rounded-xl text-orange-600 font-semibold hover:border-orange-400 hover:bg-orange-50 transition flex items-center justify-center gap-2">
                    <span class="text-xl">+</span>
                    Add Section
                </button>
            </div>
        </div>

        <!-- Right Panel - Preview -->
        <div class="hidden lg:flex w-7/12 bg-gradient-to-br from-gray-100 to-gray-200 p-8 overflow-y-auto justify-center">
            <div class="h-fit">
                <div class="flex justify-between items-center mb-6 max-w-md mx-auto">
                    <h3 class="text-lg font-semibold text-gray-700">Live Preview</h3>
                    <div class="flex gap-2">
                        <button onclick="setDevice('mobile')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition device-btn active" data-device="mobile">
                            üì±
                        </button>
                        <button onclick="setDevice('tablet')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition device-btn" data-device="tablet">
                            üíª
                        </button>
                    </div>
                </div>

                <!-- Mobile Frame -->
                <div id="mobileFrame" class="w-[375px] h-[667px] bg-gray-900 rounded-[36px] p-3 shadow-2xl mx-auto">
                    <div class="w-full h-full bg-white rounded-[28px] overflow-y-auto" id="previewContent">
                        <div class="flex items-center justify-center h-full text-center p-8">
                            <div>
                                <div class="text-6xl mb-4">üè†</div>
                                <h3 class="text-xl font-bold text-gray-900 mb-2">Start Creating</h3>
                                <p class="text-gray-600 text-sm">Add sections to build your housewarming invitation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

                <!-- Add Section Modal -->
    <div id="sectionModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
            <!-- Header -->
            <div class="p-6 border-b flex justify-between items-center bg-white">
                <h3 class="text-2xl font-bold">Add New Section</h3>
                <button onclick="closeSectionModal()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
            </div>

            <!-- Tab Navigation -->
            <div class="border-b flex bg-gray-50">
                <button class="flex-1 px-6 py-4 text-sm font-medium modal-tab-btn active" onclick="switchModalTab(event, 'most-used')">
                    ‚≠ê Most Used
                </button>
                <button class="flex-1 px-6 py-4 text-sm font-medium modal-tab-btn" onclick="switchModalTab(event, 'more')">
                    ‚ûï More Sections
                </button>
            </div>

            <!-- Tab Content Container -->
            <div class="overflow-y-auto flex-1">
                <!-- Most Used Tab -->
                <div class="modal-tab-content p-6" data-modal-tab="most-used">
                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <button data-section-type="hero" onclick="addSection('hero')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üè†</div>
                            <div class="font-semibold text-sm">Hero Header</div>
                        </button>
                        <button data-section-type="homedetails" onclick="addSection('homedetails')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üè°</div>
                            <div class="font-semibold text-sm">New Home Details</div>
                        </button>
                        <button data-section-type="partyinfo" onclick="addSection('partyinfo')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üéâ</div>
                            <div class="font-semibold text-sm">Party Info</div>
                        </button>
                        <button data-section-type="rsvp" onclick="addSection('rsvp')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">‚úâÔ∏è</div>
                            <div class="font-semibold text-sm">RSVP</div>
                        </button>
                    </div>
                </div>

                <!-- More Sections Tab -->
                <div class="modal-tab-content p-6 hidden" data-modal-tab="more">
                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <button data-section-type="housetour" onclick="addSection('housetour')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üö™</div>
                            <div class="font-semibold text-sm">House Tour</div>
                        </button>
                        <button data-section-type="directions" onclick="addSection('directions')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üó∫Ô∏è</div>
                            <div class="font-semibold text-sm">Directions</div>
                        </button>
                        <button data-section-type="whattobring" onclick="addSection('whattobring')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üéÅ</div>
                            <div class="font-semibold text-sm">What to Bring</div>
                        </button>
                        <button data-section-type="thankyou" onclick="addSection('thankyou')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üôè</div>
                            <div class="font-semibold text-sm">Thank You</div>
                        </button>
                        <button data-section-type="homephotos" onclick="addSection('homephotos')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üì∏</div>
                            <div class="font-semibold text-sm">Home Photos</div>
                        </button>
                        <button data-section-type="hometour" onclick="addSection('hometour')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üè†</div>
                            <div class="font-semibold text-sm">Virtual Home Tour</div>
                        </button>
                        <button data-section-type="renovation" onclick="addSection('renovation')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üî®</div>
                            <div class="font-semibold text-sm">Renovation Journey</div>
                        </button>
                        <button data-section-type="neighborhood" onclick="addSection('neighborhood')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üó∫Ô∏è</div>
                            <div class="font-semibold text-sm">Neighborhood</div>
                        </button>
                        <button data-section-type="wishlist" onclick="addSection('wishlist')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üéÅ</div>
                            <div class="font-semibold text-sm">Wishlist</div>
                        </button>
                        <button data-section-type="parking" onclick="addSection('parking')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üÖøÔ∏è</div>
                            <div class="font-semibold text-sm">Parking & Directions</div>
                        </button>
                        <button data-section-type="petintro" onclick="addSection('petintro')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üêæ</div>
                            <div class="font-semibold text-sm">Meet Our Pets</div>
                        </button>
                        <button data-section-type="houserules" onclick="addSection('houserules')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üìã</div>
                            <div class="font-semibold text-sm">House Guidelines</div>
                        </button>
                        <button data-section-type="activities" onclick="addSection('activities')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition text-center">
                            <div class="text-4xl mb-2">üéÆ</div>
                            <div class="font-semibold text-sm">Party Activities</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Preview Button (Mobile Only) -->
    <button onclick="openMobilePreview()" class="lg:hidden fixed bottom-6 right-6 z-40 w-14 h-14 bg-gradient-to-r from-orange-500 to-orange-700 text-white rounded-full shadow-lg hover:shadow-xl transition flex items-center justify-center text-2xl">
        üëÅÔ∏è
    </button>

    <!-- Mobile Preview Modal -->
    <div id="mobilePreviewModal" class="hidden fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center p-4">
        <div class="w-full h-full flex flex-col">
            <!-- Modal Header -->
            <div class="flex justify-between items-center mb-4 px-2">
                <h3 class="text-lg font-semibold text-white">Live Preview</h3>
                <button onclick="closeMobilePreview()" class="text-white hover:text-gray-300 text-3xl w-10 h-10 flex items-center justify-center">√ó</button>
            </div>

            <!-- Device Toggle -->
            <div class="flex gap-2 justify-center mb-4">
                <button onclick="setMobilePreviewDevice('mobile')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition mobile-preview-device-btn active" data-device="mobile">
                    üì± Mobile
                </button>
                <button onclick="setMobilePreviewDevice('tablet')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition mobile-preview-device-btn" data-device="tablet">
                    üíª Tablet
                </button>
            </div>

            <!-- Mobile Frame -->
            <div class="flex-1 flex items-center justify-center overflow-auto">
                <div id="mobilePreviewFrame" class="w-[375px] h-[667px] bg-gray-900 rounded-[36px] p-3 shadow-2xl">
                    <div class="w-full h-full bg-white rounded-[28px] overflow-y-auto" id="mobilePreviewContent">
                        <!-- Preview content will be copied here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Modal -->
    <div id="qrModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-8">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">QR Code Generated</h3>
                <button onclick="closeQRModal()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
            </div>
            <div class="text-center">
                <div class="w-64 h-64 mx-auto bg-gray-100 rounded-lg flex items-center justify-center mb-4">
                    <div class="text-center">
                        <div class="text-5xl mb-2">üì±</div>
                        <div class="text-sm text-gray-600">QR Code</div>
                    </div>
                </div>
                <div class="bg-gray-50 p-3 rounded-lg mb-4 font-mono text-sm break-all" id="shareUrl">
                    https://invitegen.com/view/housewarming123
                </div>
                <button onclick="copyUrl()" class="w-full bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600 transition">
                    üìã Copy URL
                </button>
            </div>
        </div>
    </div>

    <script>
        let sectionCounter = 0;

        const sectionTemplates = {
            layout: {
                name: 'üé® Page Layout',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div class="text-sm text-gray-600">
                            <p>This section controls the overall styling and appearance of your entire invitation page.</p>
                            <p class="mt-2">Use the <strong>Style</strong> tab to customize colors, fonts, and layout.</p>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                            <input type="color" value="#9333ea" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="primaryColor" oninput="updatePreview()">
                            <p class="text-xs text-gray-500 mt-1">Used for headings and accents</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Secondary Color</label>
                            <input type="color" value="#ec4899" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="secondaryColor" oninput="updatePreview()">
                            <p class="text-xs text-gray-500 mt-1">Used for secondary elements</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bgColor" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#1f2937" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="textColor" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Font Family</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="fontFamily" onchange="updatePreview()">
                                <option value="system-ui, -apple-system, sans-serif">System Default</option>
                                <option value="Georgia, serif">Georgia (Serif)</option>
                                <option value="'Times New Roman', serif">Times New Roman</option>
                                <option value="'Courier New', monospace">Courier New</option>
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="'Comic Sans MS', cursive">Comic Sans</option>
                                <option value="'Brush Script MT', cursive">Brush Script</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Border Radius</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="borderRadius" onchange="updatePreview()">
                                <option value="0px">Square (No Radius)</option>
                                <option value="4px">Small (4px)</option>
                                <option value="8px" selected>Medium (8px)</option>
                                <option value="16px">Large (16px)</option>
                                <option value="24px">Extra Large (24px)</option>
                                <option value="9999px">Pill Shape</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Spacing</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="spacing" onchange="updatePreview()">
                                <option value="compact">Compact</option>
                                <option value="normal" selected>Normal</option>
                                <option value="relaxed">Relaxed</option>
                                <option value="spacious">Spacious</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => '' // Layout section doesn't render visible content
            },
            hero: {
                name: 'üè† Hero Header',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Host Names</label>
                            <input type="text" placeholder="The Smith Family" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent section-data" data-field="hosts" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Title Text</label>
                            <input type="text" placeholder="Housewarming Party" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Subtitle</label>
                            <input type="text" placeholder="Join us in celebrating our new home" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent section-data" data-field="subtitle" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Home Photo</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-orange-400 cursor-pointer" onclick="this.querySelector('input').click()">
                                <div class="text-3xl mb-2">üì∏</div>
                                <div class="text-sm text-gray-600">Click to upload home photo</div>
                                <input type="file" class="hidden section-data" data-field="image" accept="image/*" onchange="handleImageUpload(this)">
                            </div>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="centered">Centered Classic</option>
                                <option value="minimal">Minimal Modern</option>
                                <option value="bold">Bold & Dramatic</option>
                                <option value="elegant">Elegant Card</option>
                                <option value="overlap">Overlapping Photo</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="bgStyle" onchange="updatePreview()">
                                <option value="solid">Solid Color</option>
                                <option value="gradient">Gradient</option>
                                <option value="pattern">Subtle Pattern</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Secondary Color (for gradients)</label>
                            <input type="color" value="#fb923c" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg2" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="text" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Image Shape</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="imageShape" onchange="updatePreview()">
                                <option value="circle">Circle</option>
                                <option value="rounded">Rounded Square</option>
                                <option value="square">Square</option>
                                <option value="wide">Wide Rectangle</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Add Shadow</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="shadow" onchange="updatePreview()">
                                <option value="none">No Shadow</option>
                                <option value="sm">Small Shadow</option>
                                <option value="md">Medium Shadow</option>
                                <option value="lg">Large Shadow</option>
                                <option value="xl">Extra Large Shadow</option>
                            </select>
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'centered';
                    const bgStyle = style.bgStyle || 'solid';
                    const bg = style.bg || '#f97316';
                    const bg2 = style.bg2 || '#fb923c';
                    const textColor = style.text || '#ffffff';
                    const imageShape = style.imageShape || 'circle';
                    const shadow = style.shadow || 'none';

                    let background = bg;
                    if (bgStyle === 'gradient') {
                        background = \`linear-gradient(135deg, \${bg}, \${bg2})\`;
                    } else if (bgStyle === 'pattern') {
                        background = \`linear-gradient(135deg, \${bg} 0%, \${bg} 100%), repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.05) 10px, rgba(255,255,255,0.05) 20px)\`;
                    }

                    const shadowClass = shadow !== 'none' ? \`shadow-\${shadow}\` : '';

                    let imageClass = 'mx-auto mb-6 object-cover';
                    if (imageShape === 'circle') {
                        imageClass += ' w-32 h-32 rounded-full border-4 border-white';
                    } else if (imageShape === 'rounded') {
                        imageClass += ' w-40 h-40 rounded-2xl border-4 border-white';
                    } else if (imageShape === 'square') {
                        imageClass += ' w-40 h-40 border-4 border-white';
                    } else if (imageShape === 'wide') {
                        imageClass += ' w-full max-w-md h-48 rounded-xl border-4 border-white';
                    }

                    if (layout === 'centered') {
                        return \`
                            <div class="text-center py-16 px-6" style="background: \${background}; color: \${textColor}">
                                \${data.image ? \`<img src="\${data.image}" class="\${imageClass} \${shadowClass}">\` : '<div class="text-6xl mb-4">üè†</div>'}
                                <h1 class="text-3xl font-bold mb-2">\${data.title || 'Housewarming Party'}</h1>
                                <p class="text-xl opacity-90">\${data.hosts || "Host Names"}</p>
                                \${data.subtitle ? \`<p class="text-sm mt-3 opacity-75">\${data.subtitle}</p>\` : ''}
                            </div>
                        \`;
                    } else if (layout === 'minimal') {
                        return \`
                            <div class="py-20 px-6" style="background: \${background}; color: \${textColor}">
                                <div class="max-w-2xl mx-auto text-center space-y-6">
                                    \${data.image ? \`<img src="\${data.image}" class="\${imageClass} \${shadowClass}">\` : '<div class="text-5xl mb-2">üè†</div>'}
                                    <div class="space-y-2">
                                        <p class="text-sm uppercase tracking-wider opacity-75">\${data.hosts || "Host Names"}</p>
                                        <h1 class="text-4xl font-light">\${data.title || 'Housewarming Party'}</h1>
                                        \${data.subtitle ? \`<p class="text-base opacity-80">\${data.subtitle}</p>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'bold') {
                        return \`
                            <div class="relative py-24 px-6 overflow-hidden" style="background: \${background}; color: \${textColor}">
                                <div class="relative z-10 max-w-2xl mx-auto text-center">
                                    \${data.image ? \`<img src="\${data.image}" class="\${imageClass} \${shadowClass}">\` : '<div class="text-7xl mb-6">üè†</div>'}
                                    <h1 class="text-5xl font-extrabold mb-3 tracking-tight">\${data.title || 'Housewarming Party'}</h1>
                                    <div class="w-24 h-1 bg-white mx-auto mb-4 opacity-75"></div>
                                    <p class="text-2xl font-medium">\${data.hosts || "Host Names"}</p>
                                    \${data.subtitle ? \`<p class="text-lg mt-4 opacity-90">\${data.subtitle}</p>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'elegant') {
                        return \`
                            <div class="py-12 px-6" style="background: \${background}; color: \${textColor}">
                                <div class="max-w-md mx-auto bg-white bg-opacity-10 backdrop-blur-sm rounded-3xl p-8 \${shadowClass}" style="border: 2px solid rgba(255,255,255,0.2)">
                                    \${data.image ? \`<img src="\${data.image}" class="\${imageClass}">\` : '<div class="text-6xl mb-4 text-center">üè†</div>'}
                                    <div class="text-center space-y-3">
                                        <h1 class="text-3xl font-serif font-bold">\${data.title || 'Housewarming Party'}</h1>
                                        <p class="text-lg">\${data.hosts || "Host Names"}</p>
                                        \${data.subtitle ? \`<p class="text-sm opacity-90 italic">\${data.subtitle}</p>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'overlap') {
                        return \`
                            <div class="relative py-24 px-6" style="background: \${background}; color: \${textColor}">
                                <div class="max-w-lg mx-auto">
                                    \${data.image ? \`
                                        <div class="relative mb-16">
                                            <img src="\${data.image}" class="w-full h-56 object-cover rounded-2xl \${shadowClass}">
                                            <div class="absolute -bottom-12 left-1/2 transform -translate-x-1/2 bg-white rounded-2xl p-6 w-11/12 \${shadowClass}" style="color: #1f2937">
                                                <h1 class="text-2xl font-bold mb-1">\${data.title || 'Housewarming Party'}</h1>
                                                <p class="text-base text-gray-600">\${data.hosts || "Host Names"}</p>
                                                \${data.subtitle ? \`<p class="text-sm text-gray-500 mt-2">\${data.subtitle}</p>\` : ''}
                                            </div>
                                        </div>
                                    \` : \`
                                        <div class="text-center">
                                            <div class="text-6xl mb-4">üè†</div>
                                            <h1 class="text-3xl font-bold mb-2">\${data.title || 'Housewarming Party'}</h1>
                                            <p class="text-xl">\${data.hosts || "Host Names"}</p>
                                            \${data.subtitle ? \`<p class="text-sm mt-3 opacity-75">\${data.subtitle}</p>\` : ''}
                                        </div>
                                    \`}
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            homedetails: {
                name: 'üè° New Home Details',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our New Home" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Home Address</label>
                            <textarea placeholder="123 Main Street, City, State ZIP" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="address" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Home Description</label>
                            <textarea placeholder="Beautiful 3-bedroom home in quiet neighborhood..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="description" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Home Features (one per line)</label>
                            <textarea placeholder="3 Bedrooms&#10;2 Bathrooms&#10;Large backyard&#10;Modern kitchen" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="features" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Layout</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="classic">Classic Card</option>
                                <option value="modern">Modern Minimal</option>
                                <option value="bordered">Bordered Accent</option>
                                <option value="split">Split Layout</option>
                                <option value="floating">Floating Card</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Color</label>
                            <input type="color" value="#fff7ed" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="cardBg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Alignment</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="align" onchange="updatePreview()">
                                <option value="center">Center</option>
                                <option value="left">Left</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Show Icon</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="showIcon" onchange="updatePreview()">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'classic';
                    const bg = style.bg || '#ffffff';
                    const cardBg = style.cardBg || '#fff7ed';
                    const accent = style.accent || '#f97316';
                    const align = style.align || 'center';
                    const showIcon = style.showIcon !== 'no';
                    const title = data.title || 'Our New Home';
                    const features = data.features ? data.features.split('\n').filter(f => f.trim()) : [];

                    if (layout === 'classic') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto text-\${align}">
                                    <h2 class="text-2xl font-bold mb-6">\${title}</h2>
                                    <div class="p-6 rounded-lg shadow-sm" style="background: \${cardBg}">
                                        \${showIcon ? '<div class="text-4xl mb-3">üè°</div>' : ''}
                                        \${data.address ? \`<div class="font-medium text-lg mb-3">\${data.address}</div>\` : ''}
                                        \${data.description ? \`<p class="text-gray-700 text-sm mb-4">\${data.description}</p>\` : ''}
                                        \${features.length > 0 ? \`
                                            <div class="mt-4 space-y-2">
                                                \${features.map(f => \`<div class="flex items-center \${align === 'center' ? 'justify-center' : ''} gap-2 text-sm"><span style="color: \${accent}">‚úì</span><span>\${f}</span></div>\`).join('')}
                                            </div>
                                        \` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'modern') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-lg mx-auto">
                                    \${showIcon ? '<div class="text-5xl mb-4 text-center">üè°</div>' : ''}
                                    <h2 class="text-3xl font-bold mb-3 text-center">\${title}</h2>
                                    \${data.address ? \`<div class="text-center text-gray-600 mb-6 text-sm">\${data.address}</div>\` : ''}
                                    <div class="space-y-6">
                                        \${data.description ? \`<p class="text-gray-700 text-center leading-relaxed">\${data.description}</p>\` : ''}
                                        \${features.length > 0 ? \`
                                            <div class="grid grid-cols-2 gap-3">
                                                \${features.map(f => \`
                                                    <div class="p-3 rounded-lg text-sm text-center" style="background: \${cardBg}; border-left: 3px solid \${accent}">
                                                        \${f}
                                                    </div>
                                                \`).join('')}
                                            </div>
                                        \` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'bordered') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <div class="border-4 rounded-xl p-8" style="border-color: \${accent}; background: \${cardBg}">
                                        \${showIcon ? '<div class="text-5xl mb-4 text-center">üè°</div>' : ''}
                                        <h2 class="text-2xl font-bold mb-4 text-center" style="color: \${accent}">\${title}</h2>
                                        \${data.address ? \`<div class="text-center font-medium mb-4 text-lg">\${data.address}</div>\` : ''}
                                        <div class="h-1 w-16 mx-auto mb-4" style="background: \${accent}"></div>
                                        \${data.description ? \`<p class="text-gray-700 text-center mb-4">\${data.description}</p>\` : ''}
                                        \${features.length > 0 ? \`
                                            <div class="mt-4 space-y-2">
                                                \${features.map(f => \`<div class="flex items-center justify-center gap-2"><span style="color: \${accent}">‚óè</span><span>\${f}</span></div>\`).join('')}
                                            </div>
                                        \` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'split') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-2xl mx-auto">
                                    <div class="rounded-xl overflow-hidden shadow-md" style="background: \${cardBg}">
                                        <div class="p-6 text-white text-center" style="background: \${accent}">
                                            \${showIcon ? '<div class="text-5xl mb-3">üè°</div>' : ''}
                                            <h2 class="text-2xl font-bold mb-2">\${title}</h2>
                                            \${data.address ? \`<div class="text-sm opacity-90">\${data.address}</div>\` : ''}
                                        </div>
                                        <div class="p-6">
                                            \${data.description ? \`<p class="text-gray-700 mb-4 text-center">\${data.description}</p>\` : ''}
                                            \${features.length > 0 ? \`
                                                <div class="grid grid-cols-2 gap-3">
                                                    \${features.map(f => \`
                                                        <div class="flex items-center gap-2 text-sm">
                                                            <span style="color: \${accent}">‚úì</span>
                                                            <span>\${f}</span>
                                                        </div>
                                                    \`).join('')}
                                                </div>
                                            \` : ''}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'floating') {
                        return \`
                            <div class="py-16 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <div class="bg-white rounded-2xl shadow-2xl p-8 transform hover:scale-105 transition-transform" style="border-top: 6px solid \${accent}">
                                        <div class="text-center mb-6">
                                            \${showIcon ? \`<div class="w-16 h-16 rounded-full flex items-center justify-center text-3xl mx-auto mb-4" style="background: \${cardBg}">\nüè°\n</div>\` : ''}
                                            <h2 class="text-2xl font-bold mb-2">\${title}</h2>
                                            \${data.address ? \`<div class="text-gray-600 text-sm">\${data.address}</div>\` : ''}
                                        </div>
                                        \${data.description ? \`<p class="text-gray-700 text-center mb-6 leading-relaxed">\${data.description}</p>\` : ''}
                                        \${features.length > 0 ? \`
                                            <div class="space-y-3">
                                                \${features.map(f => \`
                                                    <div class="flex items-center gap-3 p-2 rounded-lg" style="background: \${cardBg}">
                                                        <div class="w-6 h-6 rounded-full flex items-center justify-center text-white text-xs" style="background: \${accent}">‚úì</div>
                                                        <span class="text-sm">\${f}</span>
                                                    </div>
                                                \`).join('')}
                                            </div>
                                        \` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            partyinfo: {
                name: 'üéâ Party Info',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Party Details" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Party Date</label>
                            <input type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="date" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Party Time</label>
                            <input type="time" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="time" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Duration</label>
                            <input type="text" placeholder="3-7 PM" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="duration" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dress Code</label>
                            <input type="text" placeholder="Casual" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="dressCode" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Special Notes</label>
                            <textarea placeholder="Food and drinks provided..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="notes" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Info Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="cards">Info Cards</option>
                                <option value="timeline">Timeline Style</option>
                                <option value="grid">Grid Layout</option>
                                <option value="minimal">Minimal List</option>
                                <option value="banner">Banner Style</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fff7ed" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card/Item Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="cardBg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Icon Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="iconStyle" onchange="updatePreview()">
                                <option value="emoji">Emoji Icons</option>
                                <option value="circle">Circle Badges</option>
                                <option value="square">Square Badges</option>
                            </select>
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'cards';
                    const bg = style.bg || '#fff7ed';
                    const cardBg = style.cardBg || '#ffffff';
                    const accent = style.accent || '#f97316';
                    const iconStyle = style.iconStyle || 'emoji';
                    const title = data.title || 'Party Details';

                    const formatDate = (dateStr) => {
                        if (!dateStr) return '';
                        return new Date(dateStr).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'});
                    };

                    const getIcon = (type, emoji) => {
                        if (iconStyle === 'emoji') return \`<div class="text-2xl">\${emoji}</div>\`;
                        if (iconStyle === 'circle') return \`<div class="w-10 h-10 rounded-full flex items-center justify-center text-white text-sm" style="background: \${accent}">\${emoji}</div>\`;
                        if (iconStyle === 'square') return \`<div class="w-10 h-10 rounded-lg flex items-center justify-center text-white text-sm" style="background: \${accent}">\${emoji}</div>\`;
                    };

                    if (layout === 'cards') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <h2 class="text-2xl font-bold text-center mb-8">\${title}</h2>
                                <div class="max-w-md mx-auto space-y-4">
                                    \${data.date ? \`
                                    <div class="flex items-start gap-4 p-4 rounded-lg shadow-sm" style="background: \${cardBg}">
                                        \${getIcon('date', 'üìÖ')}
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Date</div>
                                            <div class="font-medium">\${formatDate(data.date)}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.time || data.duration ? \`
                                    <div class="flex items-start gap-4 p-4 rounded-lg shadow-sm" style="background: \${cardBg}">
                                        \${getIcon('time', 'üïê')}
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Time</div>
                                            <div class="font-medium">\${data.duration || data.time}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.dressCode ? \`
                                    <div class="flex items-start gap-4 p-4 rounded-lg shadow-sm" style="background: \${cardBg}">
                                        \${getIcon('dress', 'üëî')}
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Dress Code</div>
                                            <div class="font-medium">\${data.dressCode}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.notes ? \`
                                    <div class="p-4 rounded-lg shadow-sm" style="background: \${cardBg}">
                                        <p class="text-sm text-gray-700">\${data.notes}</p>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'timeline') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <h2 class="text-2xl font-bold text-center mb-8">\${title}</h2>
                                <div class="max-w-md mx-auto">
                                    <div class="relative pl-8 space-y-6">
                                        <div class="absolute left-3 top-0 bottom-0 w-0.5" style="background: \${accent}"></div>
                                        \${data.date ? \`
                                        <div class="relative">
                                            <div class="absolute -left-8 w-6 h-6 rounded-full border-4 border-white shadow" style="background: \${accent}"></div>
                                            <div class="p-4 rounded-lg" style="background: \${cardBg}">
                                                <div class="text-sm font-medium" style="color: \${accent}">üìÖ Date</div>
                                                <div class="font-medium mt-1">\${formatDate(data.date)}</div>
                                            </div>
                                        </div>\` : ''}
                                        \${data.time || data.duration ? \`
                                        <div class="relative">
                                            <div class="absolute -left-8 w-6 h-6 rounded-full border-4 border-white shadow" style="background: \${accent}"></div>
                                            <div class="p-4 rounded-lg" style="background: \${cardBg}">
                                                <div class="text-sm font-medium" style="color: \${accent}">üïê Time</div>
                                                <div class="font-medium mt-1">\${data.duration || data.time}</div>
                                            </div>
                                        </div>\` : ''}
                                        \${data.dressCode ? \`
                                        <div class="relative">
                                            <div class="absolute -left-8 w-6 h-6 rounded-full border-4 border-white shadow" style="background: \${accent}"></div>
                                            <div class="p-4 rounded-lg" style="background: \${cardBg}">
                                                <div class="text-sm font-medium" style="color: \${accent}">üëî Dress Code</div>
                                                <div class="font-medium mt-1">\${data.dressCode}</div>
                                            </div>
                                        </div>\` : ''}
                                    </div>
                                    \${data.notes ? \`
                                    <div class="mt-6 p-4 rounded-lg" style="background: \${cardBg}; border-left: 4px solid \${accent}">
                                        <p class="text-sm text-gray-700">\${data.notes}</p>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'grid') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <h2 class="text-2xl font-bold text-center mb-8">\${title}</h2>
                                <div class="max-w-lg mx-auto">
                                    <div class="grid grid-cols-2 gap-4 mb-4">
                                        \${data.date ? \`
                                        <div class="p-4 rounded-lg text-center" style="background: \${cardBg}">
                                            <div class="text-3xl mb-2">üìÖ</div>
                                            <div class="text-xs text-gray-500 mb-1">Date</div>
                                            <div class="font-medium text-sm">\${formatDate(data.date)}</div>
                                        </div>\` : ''}
                                        \${data.time || data.duration ? \`
                                        <div class="p-4 rounded-lg text-center" style="background: \${cardBg}">
                                            <div class="text-3xl mb-2">üïê</div>
                                            <div class="text-xs text-gray-500 mb-1">Time</div>
                                            <div class="font-medium text-sm">\${data.duration || data.time}</div>
                                        </div>\` : ''}
                                        \${data.dressCode ? \`
                                        <div class="p-4 rounded-lg text-center col-span-2" style="background: \${cardBg}">
                                            <div class="text-3xl mb-2">üëî</div>
                                            <div class="text-xs text-gray-500 mb-1">Dress Code</div>
                                            <div class="font-medium text-sm">\${data.dressCode}</div>
                                        </div>\` : ''}
                                    </div>
                                    \${data.notes ? \`
                                    <div class="p-4 rounded-lg" style="background: \${cardBg}">
                                        <p class="text-sm text-gray-700 text-center">\${data.notes}</p>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'minimal') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto text-center space-y-6">
                                    <h2 class="text-2xl font-bold mb-6">\${title}</h2>
                                    \${data.date ? \`
                                    <div>
                                        <div class="text-xs uppercase tracking-wider text-gray-500 mb-1">Date</div>
                                        <div class="text-lg font-medium">\${formatDate(data.date)}</div>
                                    </div>\` : ''}
                                    \${data.time || data.duration ? \`
                                    <div>
                                        <div class="text-xs uppercase tracking-wider text-gray-500 mb-1">Time</div>
                                        <div class="text-lg font-medium">\${data.duration || data.time}</div>
                                    </div>\` : ''}
                                    \${data.dressCode ? \`
                                    <div>
                                        <div class="text-xs uppercase tracking-wider text-gray-500 mb-1">Dress Code</div>
                                        <div class="text-lg font-medium">\${data.dressCode}</div>
                                    </div>\` : ''}
                                    \${data.notes ? \`
                                    <div class="mt-6 pt-6 border-t-2" style="border-color: \${accent}">
                                        <p class="text-sm text-gray-700">\${data.notes}</p>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'banner') {
                        return \`
                            <div class="py-0" style="background: \${bg}">
                                <div class="text-white text-center py-12" style="background: \${accent}">
                                    <h2 class="text-3xl font-bold mb-8">\${title}</h2>
                                    <div class="max-w-3xl mx-auto px-6">
                                        <div class="flex flex-wrap justify-center gap-8 text-left">
                                            \${data.date ? \`
                                            <div class="flex items-start gap-3">
                                                <div class="text-3xl">üìÖ</div>
                                                <div>
                                                    <div class="text-xs opacity-75 mb-1">Date</div>
                                                    <div class="font-medium">\${formatDate(data.date)}</div>
                                                </div>
                                            </div>\` : ''}
                                            \${data.time || data.duration ? \`
                                            <div class="flex items-start gap-3">
                                                <div class="text-3xl">üïê</div>
                                                <div>
                                                    <div class="text-xs opacity-75 mb-1">Time</div>
                                                    <div class="font-medium">\${data.duration || data.time}</div>
                                                </div>
                                            </div>\` : ''}
                                            \${data.dressCode ? \`
                                            <div class="flex items-start gap-3">
                                                <div class="text-3xl">üëî</div>
                                                <div>
                                                    <div class="text-xs opacity-75 mb-1">Dress Code</div>
                                                    <div class="font-medium">\${data.dressCode}</div>
                                                </div>
                                            </div>\` : ''}
                                        </div>
                                        \${data.notes ? \`
                                        <div class="mt-8 p-4 bg-white bg-opacity-20 rounded-lg backdrop-blur-sm">
                                            <p class="text-sm">\${data.notes}</p>
                                        </div>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            housetour: {
                name: 'üö™ House Tour',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="House Tour" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tour Schedule</label>
                            <input type="text" placeholder="Tours starting at 2 PM" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="schedule" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tour Details</label>
                            <textarea placeholder="Feel free to explore all rooms..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="details" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tour Highlights (one per line)</label>
                            <textarea placeholder="Living Room&#10;Kitchen&#10;Master Bedroom&#10;Backyard" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="highlights" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="centered">Centered Classic</option>
                                <option value="checklist">Checklist Style</option>
                                <option value="cards">Highlight Cards</option>
                                <option value="badge">Badge Layout</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'centered';
                    const bg = style.bg || '#ffffff';
                    const accent = style.accent || '#f97316';
                    const title = data.title || 'House Tour';
                    const highlights = data.highlights ? data.highlights.split('\n').filter(h => h.trim()) : [];

                    if (layout === 'centered') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto text-center">
                                    <div class="text-5xl mb-4">üö™</div>
                                    <h2 class="text-2xl font-bold mb-4">\${title}</h2>
                                    \${data.schedule ? \`<p class="text-lg mb-4" style="color: \${accent}">\${data.schedule}</p>\` : ''}
                                    \${data.details ? \`<div class="p-4 rounded-lg mb-4" style="background: \${accent}20"><p class="text-gray-600 text-sm">\${data.details}</p></div>\` : ''}
                                    \${highlights.length > 0 ? \`
                                        <div class="mt-6 space-y-2">
                                            \${highlights.map(h => \`<div class="text-gray-700">üè† \${h}</div>\`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'checklist') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold mb-2 text-center">\${title}</h2>
                                    \${data.schedule ? \`<p class="text-center mb-6 text-sm" style="color: \${accent}">\${data.schedule}</p>\` : ''}
                                    \${data.details ? \`<p class="text-gray-600 text-center text-sm mb-6">\${data.details}</p>\` : ''}
                                    \${highlights.length > 0 ? \`
                                        <div class="space-y-3">
                                            \${highlights.map(h => \`
                                                <div class="flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm">
                                                    <div class="w-6 h-6 rounded-full flex items-center justify-center text-white text-xs" style="background: \${accent}">‚úì</div>
                                                    <span class="text-gray-700">\${h}</span>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'cards') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold mb-2 text-center">\${title}</h2>
                                    \${data.schedule ? \`<p class="text-center mb-4" style="color: \${accent}">\${data.schedule}</p>\` : ''}
                                    \${data.details ? \`<p class="text-gray-600 text-center text-sm mb-6">\${data.details}</p>\` : ''}
                                    \${highlights.length > 0 ? \`
                                        <div class="grid grid-cols-2 gap-3">
                                            \${highlights.map(h => \`
                                                <div class="p-4 bg-white rounded-lg shadow-sm text-center border-t-4" style="border-color: \${accent}">
                                                    <div class="text-2xl mb-2">üö™</div>
                                                    <div class="text-sm font-medium">\${h}</div>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'badge') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-lg mx-auto text-center">
                                    <div class="text-4xl mb-3">üö™</div>
                                    <h2 class="text-2xl font-bold mb-4">\${title}</h2>
                                    \${data.schedule ? \`<p class="mb-4" style="color: \${accent}">\${data.schedule}</p>\` : ''}
                                    \${data.details ? \`<p class="text-gray-600 text-sm mb-6">\${data.details}</p>\` : ''}
                                    \${highlights.length > 0 ? \`
                                        <div class="flex flex-wrap justify-center gap-2">
                                            \${highlights.map(h => \`
                                                <span class="px-4 py-2 rounded-full text-white text-sm font-medium" style="background: \${accent}">
                                                    \${h}
                                                </span>
                                            \`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            directions: {
                name: 'üó∫Ô∏è Directions & Parking',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Directions & Parking" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                            <input type="text" placeholder="123 Main Street, City, State" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="address" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Driving Directions</label>
                            <textarea placeholder="From highway, take exit 5..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="directions" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Parking Info</label>
                            <textarea placeholder="Street parking available, driveway..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="parking" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Public Transit</label>
                            <input type="text" placeholder="Bus line 12, Metro station nearby" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="transit" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="cards">Info Cards</option>
                                <option value="list">Simple List</option>
                                <option value="boxes">Icon Boxes</option>
                                <option value="compact">Compact View</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fff7ed" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'cards';
                    const bg = style.bg || '#fff7ed';
                    const accent = style.accent || '#f97316';
                    const title = data.title || 'Directions & Parking';

                    if (layout === 'cards') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <h2 class="text-2xl font-bold text-center mb-8">\${title}</h2>
                                <div class="max-w-md mx-auto space-y-4">
                                    \${data.address ? \`
                                    <div class="flex items-start gap-4 p-4 bg-white rounded-lg shadow-sm">
                                        <div class="text-2xl">üìç</div>
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Address</div>
                                            <div class="text-sm font-medium">\${data.address}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.directions ? \`
                                    <div class="flex items-start gap-4 p-4 bg-white rounded-lg shadow-sm">
                                        <div class="text-2xl">üó∫Ô∏è</div>
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Directions</div>
                                            <div class="text-sm">\${data.directions}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.parking ? \`
                                    <div class="flex items-start gap-4 p-4 bg-white rounded-lg shadow-sm">
                                        <div class="text-2xl">üöó</div>
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Parking</div>
                                            <div class="text-sm">\${data.parking}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.transit ? \`
                                    <div class="flex items-start gap-4 p-4 bg-white rounded-lg shadow-sm">
                                        <div class="text-2xl">üöá</div>
                                        <div>
                                            <div class="text-xs text-gray-500 mb-1">Public Transit</div>
                                            <div class="text-sm">\${data.transit}</div>
                                        </div>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'list') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold mb-6 text-center">\${title}</h2>
                                    <div class="space-y-4 text-sm">
                                        \${data.address ? \`<div><span style="color: \${accent}; font-weight: 600;">üìç Address:</span> \${data.address}</div>\` : ''}
                                        \${data.directions ? \`<div><span style="color: \${accent}; font-weight: 600;">üó∫Ô∏è Directions:</span> \${data.directions}</div>\` : ''}
                                        \${data.parking ? \`<div><span style="color: \${accent}; font-weight: 600;">üöó Parking:</span> \${data.parking}</div>\` : ''}
                                        \${data.transit ? \`<div><span style="color: \${accent}; font-weight: 600;">üöá Transit:</span> \${data.transit}</div>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'boxes') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <h2 class="text-2xl font-bold mb-6 text-center">\${title}</h2>
                                <div class="max-w-md mx-auto space-y-3">
                                    \${data.address ? \`
                                    <div class="p-4 bg-white rounded-lg border-l-4 text-center" style="border-color: \${accent}">
                                        <div class="text-3xl mb-2">üìç</div>
                                        <div class="text-xs text-gray-500 mb-1">Address</div>
                                        <div class="text-sm font-medium">\${data.address}</div>
                                    </div>\` : ''}
                                    \${data.directions ? \`
                                    <div class="p-4 bg-white rounded-lg text-sm">
                                        <div class="flex items-start gap-2">
                                            <span class="text-xl">üó∫Ô∏è</span>
                                            <div><span class="font-medium">Directions:</span> \${data.directions}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.parking ? \`
                                    <div class="p-4 bg-white rounded-lg text-sm">
                                        <div class="flex items-start gap-2">
                                            <span class="text-xl">üöó</span>
                                            <div><span class="font-medium">Parking:</span> \${data.parking}</div>
                                        </div>
                                    </div>\` : ''}
                                    \${data.transit ? \`
                                    <div class="p-4 bg-white rounded-lg text-sm">
                                        <div class="flex items-start gap-2">
                                            <span class="text-xl">üöá</span>
                                            <div><span class="font-medium">Transit:</span> \${data.transit}</div>
                                        </div>
                                    </div>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'compact') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto bg-white rounded-xl p-6 shadow-md">
                                    <h2 class="text-xl font-bold mb-4 text-center" style="color: \${accent}">\${title}</h2>
                                    <div class="space-y-3 text-sm">
                                        \${data.address ? \`<div class="pb-3 border-b"><div class="text-xs text-gray-500 mb-1">üìç Address</div><div class="font-medium">\${data.address}</div></div>\` : ''}
                                        \${data.directions ? \`<div class="pb-3 border-b"><div class="text-xs text-gray-500 mb-1">üó∫Ô∏è Directions</div><div>\${data.directions}</div></div>\` : ''}
                                        \${data.parking ? \`<div class="pb-3 border-b"><div class="text-xs text-gray-500 mb-1">üöó Parking</div><div>\${data.parking}</div></div>\` : ''}
                                        \${data.transit ? \`<div><div class="text-xs text-gray-500 mb-1">üöá Public Transit</div><div>\${data.transit}</div></div>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            whattobring: {
                name: 'üéÅ What to Bring',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="What to Bring" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Message</label>
                            <textarea placeholder="Your presence is the best gift! If you'd like to bring something..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="message" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Suggested Items (one per line)</label>
                            <textarea placeholder="Drinks&#10;Snacks&#10;Desserts" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="items" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="simple">Simple Message</option>
                                <option value="list">Item List</option>
                                <option value="cards">Item Cards</option>
                                <option value="elegant">Elegant Card</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'simple';
                    const bg = style.bg || '#ffffff';
                    const accent = style.accent || '#f97316';
                    const title = data.title || 'What to Bring';
                    const items = data.items ? data.items.split('\n').filter(i => i.trim()) : [];

                    if (layout === 'simple') {
                        return \`
                            <div class="py-12 px-6 text-center" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <div class="text-5xl mb-4">üéÅ</div>
                                    <h2 class="text-2xl font-bold mb-4">\${title}</h2>
                                    <p class="text-gray-700">\${data.message || 'Your presence is the best gift!'}</p>
                                    \${items.length > 0 ? \`
                                        <div class="mt-6 text-sm text-gray-600">
                                            <p class="mb-2">Suggested items:</p>
                                            <div class="space-y-1">
                                                \${items.map(item => \`<div>‚Ä¢ \${item}</div>\`).join('')}
                                            </div>
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'list') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold mb-4 text-center">\${title}</h2>
                                    \${data.message ? \`<p class="text-gray-700 text-center mb-6 text-sm">\${data.message}</p>\` : ''}
                                    \${items.length > 0 ? \`
                                        <div class="space-y-3">
                                            \${items.map(item => \`
                                                <div class="flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm">
                                                    <div class="w-8 h-8 rounded-full flex items-center justify-center text-white" style="background: \${accent}">üéÅ</div>
                                                    <span class="text-gray-700">\${item}</span>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'cards') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-lg mx-auto">
                                    <h2 class="text-2xl font-bold mb-4 text-center">\${title}</h2>
                                    \${data.message ? \`<p class="text-gray-700 text-center mb-6 text-sm">\${data.message}</p>\` : ''}
                                    \${items.length > 0 ? \`
                                        <div class="grid grid-cols-2 gap-3">
                                            \${items.map(item => \`
                                                <div class="p-4 bg-white rounded-lg shadow-sm text-center border-t-4" style="border-color: \${accent}">
                                                    <div class="text-2xl mb-2">üéÅ</div>
                                                    <div class="text-sm font-medium">\${item}</div>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'elegant') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto bg-white rounded-2xl shadow-lg p-8">
                                    <div class="text-center mb-6">
                                        <div class="text-5xl mb-3">üéÅ</div>
                                        <h2 class="text-2xl font-bold mb-3" style="color: \${accent}">\${title}</h2>
                                        \${data.message ? \`<p class="text-gray-600 text-sm italic">\${data.message}</p>\` : ''}
                                    </div>
                                    \${items.length > 0 ? \`
                                        <div class="pt-6 border-t">
                                            <div class="space-y-2 text-sm">
                                                \${items.map(item => \`<div class="flex items-center gap-2 text-gray-700"><span style="color: \${accent}">‚úì</span> \${item}</div>\`).join('')}
                                            </div>
                                        </div>
                                    \` : ''}
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            rsvp: {
                name: '‚úâÔ∏è RSVP',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">RSVP Title</label>
                            <input type="text" placeholder="Please RSVP" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Message</label>
                            <textarea placeholder="Please let us know if you can join us..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="message" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">RSVP Deadline</label>
                            <input type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="deadline" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contact Method</label>
                            <input type="text" placeholder="Email or Phone" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="contact" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Form Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="simple">Simple Button</option>
                                <option value="card">Card Style</option>
                                <option value="boxed">Boxed Invitation</option>
                                <option value="gradient">Gradient Banner</option>
                                <option value="minimal">Minimal Text</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fff7ed" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Button/Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Button Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="buttonStyle" onchange="updatePreview()">
                                <option value="solid">Solid</option>
                                <option value="outline">Outline</option>
                                <option value="rounded">Rounded Pill</option>
                            </select>
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'simple';
                    const bg = style.bg || '#fff7ed';
                    const accent = style.accent || '#f97316';
                    const buttonStyle = style.buttonStyle || 'solid';
                    const title = data.title || 'Please RSVP';
                    const message = data.message || "Let us know if you can join us";

                    const formatDate = (dateStr) => {
                        if (!dateStr) return '';
                        return new Date(dateStr).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'});
                    };

                    let buttonClass = 'px-8 py-3 font-semibold transition';
                    if (buttonStyle === 'solid') {
                        buttonClass += ' text-white rounded-lg';
                    } else if (buttonStyle === 'outline') {
                        buttonClass += ' border-2 rounded-lg';
                    } else if (buttonStyle === 'rounded') {
                        buttonClass += ' text-white rounded-full';
                    }

                    if (layout === 'simple') {
                        return \`
                            <div class="py-12 px-6 text-center" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <div class="text-4xl mb-4">‚úâÔ∏è</div>
                                    <h2 class="text-2xl font-bold mb-4">\${title}</h2>
                                    <p class="text-gray-600 mb-6">\${message}</p>
                                    \${data.deadline ? \`<p class="text-sm text-gray-500 mb-6">Please respond by \${formatDate(data.deadline)}</p>\` : ''}
                                    \${data.contact ? \`<p class="text-sm text-gray-600 mb-6">\${data.contact}</p>\` : ''}
                                    <button class="\${buttonClass}" style="background: \${buttonStyle === 'solid' || buttonStyle === 'rounded' ? accent : 'transparent'}; border-color: \${accent}; color: \${buttonStyle === 'outline' ? accent : 'white'}">
                                        RSVP Now
                                    </button>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'card') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto bg-white rounded-2xl shadow-lg p-8 text-center">
                                    <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center text-2xl" style="background: \${accent}20">
                                        ‚úâÔ∏è
                                    </div>
                                    <h2 class="text-2xl font-bold mb-3">\${title}</h2>
                                    <p class="text-gray-600 mb-4">\${message}</p>
                                    \${data.deadline ? \`<p class="text-sm mb-4" style="color: \${accent}">Respond by \${formatDate(data.deadline)}</p>\` : ''}
                                    \${data.contact ? \`<p class="text-sm text-gray-600 mb-6">\${data.contact}</p>\` : ''}
                                    <button class="\${buttonClass}" style="background: \${buttonStyle === 'solid' || buttonStyle === 'rounded' ? accent : 'transparent'}; border-color: \${accent}; color: \${buttonStyle === 'outline' ? accent : 'white'}">
                                        RSVP Now
                                    </button>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'boxed') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto border-4 rounded-xl p-8 text-center" style="border-color: \${accent}; background: white">
                                    <div class="text-5xl mb-4">‚úâÔ∏è</div>
                                    <div class="h-1 w-20 mx-auto mb-4" style="background: \${accent}"></div>
                                    <h2 class="text-2xl font-bold mb-3" style="color: \${accent}">\${title}</h2>
                                    <p class="text-gray-700 mb-4">\${message}</p>
                                    \${data.deadline ? \`<div class="bg-gray-50 rounded-lg p-3 mb-4"><p class="text-sm text-gray-700">Please respond by<br><strong>\${formatDate(data.deadline)}</strong></p></div>\` : ''}
                                    \${data.contact ? \`<p class="text-sm text-gray-600 mb-6">\${data.contact}</p>\` : ''}
                                    <button class="\${buttonClass}" style="background: \${buttonStyle === 'solid' || buttonStyle === 'rounded' ? accent : 'transparent'}; border-color: \${accent}; color: \${buttonStyle === 'outline' ? accent : 'white'}">
                                        Confirm Attendance
                                    </button>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'gradient') {
                        return \`
                            <div class="text-white text-center py-16 px-6" style="background: linear-gradient(135deg, \${accent}, \${accent}dd)">
                                <div class="max-w-md mx-auto">
                                    <div class="text-5xl mb-4">‚úâÔ∏è</div>
                                    <h2 class="text-3xl font-bold mb-4">\${title}</h2>
                                    <p class="text-lg mb-6 opacity-90">\${message}</p>
                                    \${data.deadline ? \`<p class="text-sm mb-6 opacity-80">Respond by \${formatDate(data.deadline)}</p>\` : ''}
                                    \${data.contact ? \`<p class="text-sm mb-6 opacity-80">\${data.contact}</p>\` : ''}
                                    <button class="bg-white px-8 py-3 rounded-lg font-semibold transition hover:shadow-lg" style="color: \${accent}">
                                        RSVP Now
                                    </button>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'minimal') {
                        return \`
                            <div class="py-12 px-6 text-center" style="background: \${bg}">
                                <div class="max-w-md mx-auto space-y-4">
                                    <h2 class="text-2xl font-light">\${title}</h2>
                                    <p class="text-gray-600">\${message}</p>
                                    \${data.deadline ? \`<p class="text-sm text-gray-500">Deadline: \${formatDate(data.deadline)}</p>\` : ''}
                                    \${data.contact ? \`<p class="text-sm text-gray-600">\${data.contact}</p>\` : ''}
                                    <div class="pt-4">
                                        <button class="\${buttonClass}" style="background: \${buttonStyle === 'solid' || buttonStyle === 'rounded' ? accent : 'transparent'}; border-color: \${accent}; color: \${buttonStyle === 'outline' ? accent : 'white'}">
                                            Respond
                                        </button>
                                    </div>
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            homephotos: {
                name: 'üì∏ Home Photos',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gallery Title</label>
                            <input type="text" placeholder="Home Tour" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea placeholder="Sneak peek of our new place..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="description" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Photos</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-orange-400 cursor-pointer">
                                <div class="text-3xl mb-2">üì∏</div>
                                <div class="text-sm text-gray-600">Click to upload photos</div>
                            </div>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gallery Layout</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="grid2">2-Column Grid</option>
                                <option value="grid3">3-Column Grid</option>
                                <option value="masonry">Masonry Style</option>
                                <option value="carousel">Carousel Style</option>
                                <option value="featured">Featured & Grid</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Photo Count</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="photoCount" onchange="updatePreview()">
                                <option value="4">4 Photos</option>
                                <option value="6">6 Photos</option>
                                <option value="8">8 Photos</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Corner Radius</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="radius" onchange="updatePreview()">
                                <option value="none">Square</option>
                                <option value="sm">Small Rounded</option>
                                <option value="md">Medium Rounded</option>
                                <option value="lg">Large Rounded</option>
                                <option value="full">Circle/Pill</option>
                            </select>
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'grid2';
                    const bg = style.bg || '#ffffff';
                    const accent = style.accent || '#f97316';
                    const photoCount = parseInt(style.photoCount || '4');
                    const radius = style.radius || 'md';
                    const title = data.title || 'Home Photos';

                    let radiusClass = '';
                    if (radius === 'none') radiusClass = '';
                    else if (radius === 'sm') radiusClass = 'rounded';
                    else if (radius === 'md') radiusClass = 'rounded-lg';
                    else if (radius === 'lg') radiusClass = 'rounded-xl';
                    else if (radius === 'full') radiusClass = 'rounded-full';

                    const photos = Array(photoCount).fill('üì∑');

                    if (layout === 'grid2') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold text-center mb-4">\${title}</h2>
                                    \${data.description ? \`<p class="text-center text-gray-600 mb-6 text-sm">\${data.description}</p>\` : ''}
                                    <div class="grid grid-cols-2 gap-4">
                                        \${photos.map(icon => \`
                                            <div class="aspect-square \${radiusClass} flex items-center justify-center shadow-sm" style="background: \${accent}20">
                                                <span class="text-4xl">\${icon}</span>
                                            </div>
                                        \`).join('')}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'grid3') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-lg mx-auto">
                                    <h2 class="text-2xl font-bold text-center mb-4">\${title}</h2>
                                    \${data.description ? \`<p class="text-center text-gray-600 mb-6 text-sm">\${data.description}</p>\` : ''}
                                    <div class="grid grid-cols-3 gap-2">
                                        \${photos.map(icon => \`
                                            <div class="aspect-square \${radiusClass} flex items-center justify-center shadow-sm" style="background: \${accent}20">
                                                <span class="text-2xl">\${icon}</span>
                                            </div>
                                        \`).join('')}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'masonry') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold text-center mb-4">\${title}</h2>
                                    \${data.description ? \`<p class="text-center text-gray-600 mb-6 text-sm">\${data.description}</p>\` : ''}
                                    <div class="grid grid-cols-2 gap-3">
                                        \${photos.map((icon, i) => {
                                            const height = i % 3 === 0 ? 'h-48' : i % 3 === 1 ? 'h-32' : 'h-40';
                                            return \`
                                                <div class="\${height} \${radiusClass} flex items-center justify-center shadow-sm" style="background: \${accent}20">
                                                    <span class="text-4xl">\${icon}</span>
                                                </div>
                                            \`;
                                        }).join('')}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'carousel') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold text-center mb-4">\${title}</h2>
                                    \${data.description ? \`<p class="text-center text-gray-600 mb-6 text-sm">\${data.description}</p>\` : ''}
                                    <div class="relative">
                                        <div class="aspect-video \${radiusClass} flex items-center justify-center shadow-lg mb-4" style="background: \${accent}20">
                                            <span class="text-6xl">üì∑</span>
                                        </div>
                                        <div class="flex gap-2 justify-center">
                                            \${photos.slice(0, Math.min(5, photoCount)).map(icon => \`
                                                <div class="w-12 h-12 \${radiusClass} flex items-center justify-center shadow-sm" style="background: \${accent}20">
                                                    <span class="text-sm">\${icon}</span>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'featured') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <h2 class="text-2xl font-bold text-center mb-4">\${title}</h2>
                                    \${data.description ? \`<p class="text-center text-gray-600 mb-6 text-sm">\${data.description}</p>\` : ''}
                                    <div class="space-y-3">
                                        <div class="aspect-video \${radiusClass} flex items-center justify-center shadow-md" style="background: \${accent}20">
                                            <span class="text-6xl">üì∑</span>
                                        </div>
                                        <div class="grid grid-cols-3 gap-3">
                                            \${photos.slice(0, Math.min(3, photoCount - 1)).map(icon => \`
                                                <div class="aspect-square \${radiusClass} flex items-center justify-center shadow-sm" style="background: \${accent}20">
                                                    <span class="text-2xl">\${icon}</span>
                                                </div>
                                            \`).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            thankyou: {
                name: 'üôè Thank You',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Thank You" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Thank You Message</label>
                            <textarea placeholder="Thank you for helping us celebrate our new home..." rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="message" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Closing/Signature</label>
                            <input type="text" placeholder="See you soon! - The Smith Family" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="closing" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="simple">Simple Center</option>
                                <option value="card">Elegant Card</option>
                                <option value="warm">Warm Message</option>
                                <option value="border">Bordered Note</option>
                                <option value="minimal">Minimal Style</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fff7ed" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                            <input type="color" value="#f97316" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="accent" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => {
                    const layout = style.layout || 'simple';
                    const bg = style.bg || '#fff7ed';
                    const accent = style.accent || '#f97316';
                    const title = data.title || 'Thank You';
                    const message = data.message || 'Thank you for helping us celebrate our new home!';

                    if (layout === 'simple') {
                        return \`
                            <div class="py-12 px-6 text-center" style="background: \${bg}">
                                <div class="max-w-md mx-auto">
                                    <div class="text-5xl mb-4">üôè</div>
                                    <h2 class="text-2xl font-bold mb-6">\${title}</h2>
                                    <p class="text-gray-700 text-lg mb-6">\${message}</p>
                                    \${data.closing ? \`<p class="text-gray-600 italic">\${data.closing}</p>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'card') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto bg-white rounded-2xl shadow-xl p-8">
                                    <div class="text-center mb-6">
                                        <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl" style="background: \${accent}20">
                                            üôè
                                        </div>
                                        <h2 class="text-2xl font-bold mb-4" style="color: \${accent}">\${title}</h2>
                                        <div class="w-12 h-1 mx-auto mb-6" style="background: \${accent}"></div>
                                        <p class="text-gray-700 leading-relaxed mb-6">\${message}</p>
                                        \${data.closing ? \`<p class="text-sm italic text-gray-600 pt-4 border-t">\${data.closing}</p>\` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'warm') {
                        return \`
                            <div class="py-16 px-6 text-white text-center" style="background: linear-gradient(135deg, \${accent}, \${accent}dd)">
                                <div class="max-w-md mx-auto">
                                    <div class="text-5xl mb-4">üôè</div>
                                    <h2 class="text-3xl font-bold mb-6">\${title}</h2>
                                    <p class="text-lg mb-6 opacity-95 leading-relaxed">\${message}</p>
                                    \${data.closing ? \`<p class="text-sm italic opacity-90">\${data.closing}</p>\` : ''}
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'border') {
                        return \`
                            <div class="py-12 px-6" style="background: \${bg}">
                                <div class="max-w-md mx-auto border-4 rounded-xl p-8 bg-white" style="border-color: \${accent}">
                                    <div class="text-center">
                                        <div class="text-5xl mb-4">üôè</div>
                                        <h2 class="text-2xl font-bold mb-6" style="color: \${accent}">\${title}</h2>
                                        <p class="text-gray-700 leading-relaxed mb-6">\${message}</p>
                                        \${data.closing ? \`
                                            <div class="pt-4 border-t-2" style="border-color: \${accent}40">
                                                <p class="text-sm italic text-gray-600">\${data.closing}</p>
                                            </div>
                                        \` : ''}
                                    </div>
                                </div>
                            </div>
                        \`;
                    } else if (layout === 'minimal') {
                        return \`
                            <div class="py-16 px-6 text-center" style="background: \${bg}">
                                <div class="max-w-lg mx-auto space-y-6">
                                    <h2 class="text-3xl font-light">\${title}</h2>
                                    <p class="text-gray-700 text-lg leading-relaxed">\${message}</p>
                                    \${data.closing ? \`<p class="text-sm text-gray-500 italic">\${data.closing}</p>\` : ''}
                                </div>
                            </div>
                        \`;
                    }
                }
            },
            hometour: {
                name: 'üè† Virtual Home Tour',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Introduction</label>
                            <textarea placeholder="Take a sneak peek at our new space!" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="intro" oninput="updatePreview()"></textarea>
                        </div>
                        <div class="border-t pt-3">
                            <h4 class="font-medium text-gray-900 mb-2">Room 1</h4>
                            <input type="text" placeholder="Living Room" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="room1name" oninput="updatePreview()">
                            <textarea placeholder="Describe this room..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="room1desc" oninput="updatePreview()"></textarea>
                        </div>
                        <div class="border-t pt-3">
                            <h4 class="font-medium text-gray-900 mb-2">Room 2</h4>
                            <input type="text" placeholder="Kitchen" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="room2name" oninput="updatePreview()">
                            <textarea placeholder="Describe this room..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="room2desc" oninput="updatePreview()"></textarea>
                        </div>
                        <div class="border-t pt-3">
                            <h4 class="font-medium text-gray-900 mb-2">Room 3 (Optional)</h4>
                            <input type="text" placeholder="Backyard" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="room3name" oninput="updatePreview()">
                            <textarea placeholder="Describe this area..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="room3desc" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fef3c7" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#fef3c7'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üè†</div>
                                <h2 class="text-2xl font-bold mb-2">Virtual Home Tour</h2>
                                \${data.intro ? \`<p class="text-gray-600">\${data.intro}</p>\` : ''}
                            </div>
                            <div class="space-y-4">
                                \${data.room1name ? \`
                                <div class="bg-white rounded-lg p-4 shadow-sm">
                                    <h3 class="font-bold text-lg text-orange-600 mb-2">\${data.room1name}</h3>
                                    \${data.room1desc ? \`<p class="text-gray-700 text-sm">\${data.room1desc}</p>\` : ''}
                                </div>
                                \` : ''}
                                \${data.room2name ? \`
                                <div class="bg-white rounded-lg p-4 shadow-sm">
                                    <h3 class="font-bold text-lg text-orange-600 mb-2">\${data.room2name}</h3>
                                    \${data.room2desc ? \`<p class="text-gray-700 text-sm">\${data.room2desc}</p>\` : ''}
                                </div>
                                \` : ''}
                                \${data.room3name ? \`
                                <div class="bg-white rounded-lg p-4 shadow-sm">
                                    <h3 class="font-bold text-lg text-orange-600 mb-2">\${data.room3name}</h3>
                                    \${data.room3desc ? \`<p class="text-gray-700 text-sm">\${data.room3desc}</p>\` : ''}
                                </div>
                                \` : ''}
                            </div>
                        </div>
                    </div>
                \`
            },
            renovation: {
                name: 'üî® Renovation Journey',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Story Title</label>
                            <input type="text" placeholder="Our Renovation Journey" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Renovation Timeline</label>
                            <input type="text" placeholder="6 months, March - August 2024" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="timeline" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Renovation Story</label>
                            <textarea placeholder="Share the story of your renovation journey..." rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="story" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Key Highlights</label>
                            <textarea placeholder="‚Ä¢ New kitchen cabinets\n‚Ä¢ Hardwood floors\n‚Ä¢ Fresh paint throughout" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="highlights" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fed7aa" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#fed7aa'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üî®</div>
                                <h2 class="text-2xl font-bold mb-2">\${data.title || 'Renovation Journey'}</h2>
                                \${data.timeline ? \`<p class="text-sm text-gray-600">‚è±Ô∏è \${data.timeline}</p>\` : ''}
                            </div>
                            <div class="bg-white rounded-lg p-6 shadow-md">
                                \${data.story ? \`<p class="text-gray-700 mb-4 whitespace-pre-wrap">\${data.story}</p>\` : ''}
                                \${data.highlights ? \`
                                    <div class="border-t pt-4">
                                        <h3 class="font-semibold text-gray-900 mb-2">Highlights:</h3>
                                        <div class="text-gray-700 text-sm whitespace-pre-wrap">\${data.highlights}</div>
                                    </div>
                                \` : ''}
                            </div>
                        </div>
                    </div>
                \`
            },
            neighborhood: {
                name: 'üó∫Ô∏è Our New Neighborhood',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Neighborhood Name</label>
                            <input type="text" placeholder="Downtown Historic District" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="name" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">About the Area</label>
                            <textarea placeholder="Describe what you love about your new neighborhood..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="description" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Favorite Local Spots</label>
                            <textarea placeholder="‚Ä¢ Coffee Shop on Main St\n‚Ä¢ The Park around the corner\n‚Ä¢ Farmers Market on Saturdays" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="favorites" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fun Facts</label>
                            <textarea placeholder="Share interesting facts about the neighborhood..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="facts" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#dbeafe" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#dbeafe'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üó∫Ô∏è</div>
                                <h2 class="text-2xl font-bold mb-2">Our New Neighborhood</h2>
                                \${data.name ? \`<p class="text-lg text-orange-600 font-medium">\${data.name}</p>\` : ''}
                            </div>
                            \${data.description ? \`<p class="text-gray-700 mb-6">\${data.description}</p>\` : ''}
                            \${data.favorites ? \`
                                <div class="bg-white rounded-lg p-5 shadow-sm mb-4">
                                    <h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                        <span>‚≠ê</span>
                                        <span>Our Favorite Spots</span>
                                    </h3>
                                    <div class="text-gray-700 text-sm whitespace-pre-wrap">\${data.favorites}</div>
                                </div>
                            \` : ''}
                            \${data.facts ? \`
                                <div class="bg-orange-50 rounded-lg p-5">
                                    <h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                        <span>üí°</span>
                                        <span>Fun Facts</span>
                                    </h3>
                                    <p class="text-gray-700 text-sm">\${data.facts}</p>
                                </div>
                            \` : ''}
                        </div>
                    </div>
                \`
            },
            wishlist: {
                name: 'üéÅ Housewarming Wishlist',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Introduction Message</label>
                            <textarea placeholder="Your presence is the best gift, but if you'd like to bring something..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="intro" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Registry Link (Optional)</label>
                            <input type="url" placeholder="https://registry.com/yourname" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="registryUrl" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Wishlist Items/Categories</label>
                            <textarea placeholder="‚Ä¢ Kitchen gadgets\n‚Ä¢ Plants for the garden\n‚Ä¢ Tools for DIY projects\n‚Ä¢ Gift cards to local shops" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="items" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Alternative Suggestion</label>
                            <input type="text" placeholder="Or bring your favorite bottle of wine!" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="alternative" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fce7f3" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#fce7f3'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üéÅ</div>
                                <h2 class="text-2xl font-bold mb-4">Housewarming Wishlist</h2>
                                \${data.intro ? \`<p class="text-gray-600">\${data.intro}</p>\` : ''}
                            </div>
                            \${data.items ? \`
                                <div class="bg-white rounded-lg p-6 shadow-md mb-4">
                                    <div class="text-gray-700 whitespace-pre-wrap">\${data.items}</div>
                                </div>
                            \` : ''}
                            \${data.registryUrl ? \`
                                <div class="text-center mb-4">
                                    <a href="\${data.registryUrl}" target="_blank" class="inline-block bg-orange-500 text-white px-6 py-3 rounded-lg font-medium hover:bg-orange-600 transition">
                                        View Our Registry
                                    </a>
                                </div>
                            \` : ''}
                            \${data.alternative ? \`
                                <p class="text-center text-gray-600 italic text-sm">\${data.alternative}</p>
                            \` : ''}
                        </div>
                    </div>
                \`
            },
            parking: {
                name: 'üÖøÔ∏è Parking & Directions',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Parking Information</label>
                            <textarea placeholder="Street parking available on Main St and Oak Ave. Driveway fits 2 cars." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="parking" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Driving Directions</label>
                            <textarea placeholder="From downtown: Take Main St north for 2 miles, turn left on Oak Ave..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="directions" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Landmarks</label>
                            <textarea placeholder="Look for the blue house across from the library" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="landmarks" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">GPS Coordinates (Optional)</label>
                            <input type="text" placeholder="40.7128¬∞ N, 74.0060¬∞ W" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="gps" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#e0e7ff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#e0e7ff'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üÖøÔ∏è</div>
                                <h2 class="text-2xl font-bold">Parking & Directions</h2>
                            </div>
                            <div class="space-y-4">
                                \${data.parking ? \`
                                    <div class="bg-white rounded-lg p-5 shadow-sm">
                                        <h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                            <span>üöó</span>
                                            <span>Parking</span>
                                        </h3>
                                        <p class="text-gray-700 text-sm">\${data.parking}</p>
                                    </div>
                                \` : ''}
                                \${data.directions ? \`
                                    <div class="bg-white rounded-lg p-5 shadow-sm">
                                        <h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                            <span>üß≠</span>
                                            <span>Directions</span>
                                        </h3>
                                        <p class="text-gray-700 text-sm whitespace-pre-wrap">\${data.directions}</p>
                                    </div>
                                \` : ''}
                                \${data.landmarks ? \`
                                    <div class="bg-white rounded-lg p-5 shadow-sm">
                                        <h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                            <span>üèõÔ∏è</span>
                                            <span>Landmarks</span>
                                        </h3>
                                        <p class="text-gray-700 text-sm">\${data.landmarks}</p>
                                    </div>
                                \` : ''}
                                \${data.gps ? \`
                                    <div class="text-center">
                                        <p class="text-xs text-gray-500">GPS: \${data.gps}</p>
                                    </div>
                                \` : ''}
                            </div>
                        </div>
                    </div>
                \`
            },
            petintro: {
                name: 'üêæ Meet Our Pets',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Introduction</label>
                            <textarea placeholder="We have furry family members we'd love you to meet!" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="intro" oninput="updatePreview()"></textarea>
                        </div>
                        <div class="border-t pt-3">
                            <h4 class="font-medium text-gray-900 mb-2">Pet 1</h4>
                            <input type="text" placeholder="Pet Name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="pet1name" oninput="updatePreview()">
                            <input type="text" placeholder="Dog, Cat, etc." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="pet1type" oninput="updatePreview()">
                            <textarea placeholder="Personality & fun facts..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="pet1desc" oninput="updatePreview()"></textarea>
                        </div>
                        <div class="border-t pt-3">
                            <h4 class="font-medium text-gray-900 mb-2">Pet 2 (Optional)</h4>
                            <input type="text" placeholder="Pet Name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="pet2name" oninput="updatePreview()">
                            <input type="text" placeholder="Dog, Cat, etc." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data mb-2" data-field="pet2type" oninput="updatePreview()">
                            <textarea placeholder="Personality & fun facts..." rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="pet2desc" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Allergy Warning (Optional)</label>
                            <input type="text" placeholder="Please note: We have pets in the home" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="allergyNote" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fef9c3" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#fef9c3'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üêæ</div>
                                <h2 class="text-2xl font-bold mb-2">Meet Our Pets</h2>
                                \${data.intro ? \`<p class="text-gray-600">\${data.intro}</p>\` : ''}
                            </div>
                            <div class="space-y-4">
                                \${data.pet1name ? \`
                                    <div class="bg-white rounded-lg p-5 shadow-sm">
                                        <div class="flex items-start gap-3">
                                            <div class="text-3xl">üêï</div>
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg text-orange-600">\${data.pet1name}</h3>
                                                \${data.pet1type ? \`<p class="text-sm text-gray-500 mb-2">\${data.pet1type}</p>\` : ''}
                                                \${data.pet1desc ? \`<p class="text-gray-700 text-sm">\${data.pet1desc}</p>\` : ''}
                                            </div>
                                        </div>
                                    </div>
                                \` : ''}
                                \${data.pet2name ? \`
                                    <div class="bg-white rounded-lg p-5 shadow-sm">
                                        <div class="flex items-start gap-3">
                                            <div class="text-3xl">üêà</div>
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg text-orange-600">\${data.pet2name}</h3>
                                                \${data.pet2type ? \`<p class="text-sm text-gray-500 mb-2">\${data.pet2type}</p>\` : ''}
                                                \${data.pet2desc ? \`<p class="text-gray-700 text-sm">\${data.pet2desc}</p>\` : ''}
                                            </div>
                                        </div>
                                    </div>
                                \` : ''}
                            </div>
                            \${data.allergyNote ? \`
                                <div class="mt-6 text-center">
                                    <p class="text-xs text-gray-600 bg-yellow-50 rounded-lg py-2 px-4 inline-block">
                                        ‚ö†Ô∏è \${data.allergyNote}
                                    </p>
                                </div>
                            \` : ''}
                        </div>
                    </div>
                \`
            },
            houserules: {
                name: 'üìã House Guidelines',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Introduction Message</label>
                            <textarea placeholder="A few friendly reminders to help everyone enjoy the party..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="intro" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Guidelines</label>
                            <textarea placeholder="‚Ä¢ Please remove shoes at the door\n‚Ä¢ Feel free to tour the house\n‚Ä¢ Kids are welcome to play in the backyard\n‚Ä¢ Smoking outside only" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="rules" oninput="updatePreview()"></textarea>
                            <p class="text-xs text-gray-500">Keep the tone friendly and welcoming!</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Closing Note</label>
                            <input type="text" placeholder="Most importantly, come ready to have fun!" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="closing" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f0fdf4" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#f0fdf4'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üìã</div>
                                <h2 class="text-2xl font-bold mb-2">House Guidelines</h2>
                                \${data.intro ? \`<p class="text-gray-600">\${data.intro}</p>\` : ''}
                            </div>
                            \${data.rules ? \`
                                <div class="bg-white rounded-lg p-6 shadow-sm mb-4">
                                    <div class="text-gray-700 whitespace-pre-wrap">\${data.rules}</div>
                                </div>
                            \` : ''}
                            \${data.closing ? \`
                                <div class="text-center">
                                    <p class="text-orange-600 font-medium italic">\${data.closing}</p>
                                </div>
                            \` : ''}
                        </div>
                    </div>
                \`
            },
            activities: {
                name: 'üéÆ Party Activities',
                allowMultiple: false,
                info: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Introduction</label>
                            <textarea placeholder="Here's what we have planned for entertainment..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="intro" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Activities List</label>
                            <textarea placeholder="‚Ä¢ House tour at 2:00 PM\n‚Ä¢ Backyard games\n‚Ä¢ Music and dancing\n‚Ä¢ Photo booth in the living room\n‚Ä¢ Pool/hot tub available" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="activities" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Special Features</label>
                            <textarea placeholder="Check out our newly renovated game room!" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 section-data" data-field="features" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                \`,
                style: \`
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fae8ff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                \`,
                render: (data, style) => \`
                    <div class="py-12 px-6" style="background: \${style.bg || '#fae8ff'}">
                        <div class="max-w-md mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-5xl mb-3">üéÆ</div>
                                <h2 class="text-2xl font-bold mb-2">Party Activities</h2>
                                \${data.intro ? \`<p class="text-gray-600">\${data.intro}</p>\` : ''}
                            </div>
                            \${data.activities ? \`
                                <div class="bg-white rounded-lg p-6 shadow-sm mb-4">
                                    <div class="text-gray-700 whitespace-pre-wrap">\${data.activities}</div>
                                </div>
                            \` : ''}
                            \${data.features ? \`
                                <div class="bg-orange-50 rounded-lg p-5 border-l-4 border-orange-500">
                                    <p class="text-gray-700 font-medium">\${data.features}</p>
                                </div>
                            \` : ''}
                        </div>
                    </div>
                \`
            }
        };

        function openSectionModal() {
            updateSectionAvailability();
            document.getElementById('sectionModal').classList.remove('hidden');
        }

        function updateSectionAvailability() {
            // Get all currently added sections
            const addedSections = {};
            document.querySelectorAll('.section-item').forEach(section => {
                const type = section.dataset.type;
                addedSections[type] = (addedSections[type] || 0) + 1;
            });

            // Update each section button in the modal
            document.querySelectorAll('[data-section-type]').forEach(button => {
                const type = button.dataset.sectionType;
                const template = sectionTemplates[type];

                if (!template) return;

                const isAdded = addedSections[type] > 0;
                const allowMultiple = template.allowMultiple !== false; // Default to true if not specified

                if (isAdded && !allowMultiple) {
                    // Disable button
                    button.disabled = true;
                    button.classList.add('opacity-50', 'cursor-not-allowed', 'bg-gray-100');
                    button.classList.remove('hover:border-purple-500', 'hover:bg-purple-50');

                    // Add "Added" badge
                    if (!button.querySelector('.added-badge')) {
                        const badge = document.createElement('span');
                        badge.className = 'added-badge absolute top-2 right-2 text-xs bg-green-500 text-white px-2 py-1 rounded';
                        badge.textContent = '‚úì Added';
                        button.style.position = 'relative';
                        button.appendChild(badge);
                    }
                } else {
                    // Enable button
                    button.disabled = false;
                    button.classList.remove('opacity-50', 'cursor-not-allowed', 'bg-gray-100');
                    button.classList.add('hover:border-purple-500', 'hover:bg-purple-50');

                    // Remove "Added" badge if it exists
                    const badge = button.querySelector('.added-badge');
                    if (badge) badge.remove();
                }
            });
        }

        
        function switchModalTab(event, tabName) {
            // Remove active class from all tab buttons
            document.querySelectorAll('.modal-tab-btn').forEach(btn => {
                btn.classList.remove('active', 'text-purple-600', 'border-b-2', 'border-purple-600', 'bg-white');
            });

            // Hide all tab contents
            document.querySelectorAll('.modal-tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            // Activate clicked tab button
            event.target.classList.add('active', 'text-purple-600', 'border-b-2', 'border-purple-600', 'bg-white');

            // Show corresponding tab content
            document.querySelector(`[data-modal-tab="${tabName}"]`).classList.remove('hidden');
        }

        function closeSectionModal() {
            document.getElementById('sectionModal').classList.add('hidden');
        }

        function addSection(type) {
            const template = sectionTemplates[type];
            const id = \`section-\${sectionCounter++}\`;

            const sectionHTML = \`
                <div class="border border-gray-200 rounded-xl overflow-hidden section-item" data-id="\${id}" data-type="\${type}">
                    <div class="bg-gray-50 border-b px-4 py-3 flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <span class="cursor-move text-gray-400">‚ãÆ‚ãÆ</span>
                            <span class="font-semibold text-sm">\${template.name}</span>
                        </div>
                        <button onclick="removeSection('\${id}')" class="text-gray-400 hover:text-red-600 transition">‚úï</button>
                    </div>
                    <div class="border-b flex">
                        <button class="flex-1 px-4 py-3 text-sm font-medium border-r tab-btn active" onclick="switchTab(event, '\${id}', 'info')">
                            Info
                        </button>
                        <button class="flex-1 px-4 py-3 text-sm font-medium tab-btn" onclick="switchTab(event, '\${id}', 'style')">
                            Style
                        </button>
                    </div>
                    <div class="p-4 tab-content" data-tab="info">
                        \${template.info}
                    </div>
                    <div class="p-4 tab-content hidden" data-tab="style">
                        \${template.style}
                    </div>
                </div>
            \`;

            document.getElementById('sectionsContainer').insertAdjacentHTML('beforeend', sectionHTML);
            if (!isLayout) {
                closeSectionModal();
            }
            updatePreview();
        }

        function removeSection(id) {
            if (confirm('Remove this section?')) {
                document.querySelector(\`[data-id="\${id}"]\`).remove();
                updatePreview();
            }
        }

        function switchTab(event, sectionId, tab) {
            const section = document.querySelector(\`[data-id="\${sectionId}"]\`);
            section.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active', 'text-orange-600', 'border-b-2', 'border-orange-600'));
            section.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

            event.target.classList.add('active', 'text-orange-600', 'border-b-2', 'border-orange-600');
            section.querySelector(\`[data-tab="\${tab}"]\`).classList.remove('hidden');
        }

        function getSectionData(section) {
            const data = {};
            const style = {};

            section.querySelectorAll('.section-data').forEach(input => {
                const field = input.dataset.field;
                if (input.type === 'file' && input.dataset.imageData) {
                    data[field] = input.dataset.imageData;
                } else {
                    data[field] = input.value;
                }
            });

            section.querySelectorAll('.section-style').forEach(input => {
                style[input.dataset.style] = input.value;
            });

            return { data, style };
        }

        function updatePreview() {
            const sections = document.querySelectorAll('.section-item');
            let html = '';
            let globalStyles = {};

            // Extract global styles from layout section
            const layoutSection = document.querySelector('[data-type="layout"]');
            if (layoutSection) {
                const { style } = getSectionData(layoutSection);
                globalStyles = style;
            }

            // Apply default global styles if not set
            globalStyles = {
                primaryColor: globalStyles.primaryColor || '#9333ea',
                secondaryColor: globalStyles.secondaryColor || '#ec4899',
                bgColor: globalStyles.bgColor || '#ffffff',
                textColor: globalStyles.textColor || '#1f2937',
                fontFamily: globalStyles.fontFamily || 'system-ui, -apple-system, sans-serif',
                borderRadius: globalStyles.borderRadius || '8px',
                spacing: globalStyles.spacing || 'normal'
            };

            // Calculate spacing values
            const spacingMap = {
                compact: { py: 'py-8', px: 'px-4', gap: 'gap-2' },
                normal: { py: 'py-12', px: 'px-6', gap: 'gap-4' },
                relaxed: { py: 'py-16', px: 'px-8', gap: 'gap-6' },
                spacious: { py: 'py-20', px: 'px-10', gap: 'gap-8' }
            };

            if (sections.length === 0 || sections.length === 1) {
                html = \`
                    <div class="flex items-center justify-center h-full text-center p-8">
                        <div>
                            <div class="text-6xl mb-4">üè†</div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2">Start Creating</h3>
                            <p class="text-gray-600 text-sm">Add sections to build your housewarming invitation</p>
                        </div>
                    </div>
                \`;
            } else {
                sections.forEach(section => {
                    const type = section.dataset.type;
                    if (type === 'layout') return; // Skip layout section in rendering
                    const template = sectionTemplates[type];
                    const { data, style } = getSectionData(section);
                    html += template.render(data, style, globalStyles);
                });
            }

            // Wrap content with global styles
            const styledHtml = `
                <div style="font-family: ${globalStyles.fontFamily}; color: ${globalStyles.textColor}; background: ${globalStyles.bgColor};">
                    ${html}
                </div>
            `;

            document.getElementById('previewContent').innerHTML = styledHtml;
        }

        function handleImageUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    input.dataset.imageData = e.target.result;
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }

        function setDevice(device) {
            document.querySelectorAll('.device-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-500', 'text-white');
            });
            event.target.classList.add('active', 'bg-orange-500', 'text-white');

            const frame = document.getElementById('mobileFrame');
            if (device === 'tablet') {
                frame.style.width = '768px';
                frame.style.height = '1024px';
            } else {
                frame.style.width = '375px';
                frame.style.height = '667px';
            }
        }

        function previewFullscreen() {
            window.open('', '_blank');
            alert('Full screen preview would open here');
        }

        function generateQR() {
            document.getElementById('qrModal').classList.remove('hidden');
        }

        function closeQRModal() {
            document.getElementById('qrModal').classList.add('hidden');
        }

        function copyUrl() {
            const url = document.getElementById('shareUrl').textContent;
            navigator.clipboard.writeText(url).then(() => {
                alert('URL copied to clipboard!');
            });
        }

        function publishProject() {
            if (confirm('Publish your housewarming invitation?')) {
                alert('‚úÖ Published successfully!\n\nYour housewarming page is now live!');
            }
        }

        function openMobilePreview() {
            // Copy preview content to mobile preview modal
            const previewContent = document.getElementById('previewContent').innerHTML;
            document.getElementById('mobilePreviewContent').innerHTML = previewContent;

            // Show the modal
            document.getElementById('mobilePreviewModal').classList.remove('hidden');
        }

        function closeMobilePreview() {
            document.getElementById('mobilePreviewModal').classList.add('hidden');
        }

        function setMobilePreviewDevice(device) {
            // Update active button
            document.querySelectorAll('.mobile-preview-device-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-600', 'text-white');
            });
            event.target.classList.add('active', 'bg-orange-600', 'text-white');

            // Update frame size
            const frame = document.getElementById('mobilePreviewFrame');
            if (device === 'tablet') {
                frame.style.width = '768px';
                frame.style.height = '1024px';
            } else {
                frame.style.width = '375px';
                frame.style.height = '667px';
            }
        }

        // Initialize with default sections on page load
        function initializeDefaultSections() {
            // Add default sections here based on template type
            const defaultSections = ['hero', 'homedetails', 'partyinfo', 'rsvp'];
            defaultSections.forEach(sectionType => addSection(sectionType));
        }

        // Load default sections when page loads
        window.addEventListener('DOMContentLoaded', initializeDefaultSections);

        
        // Initialize layout section on page load
        function initializeLayout() {
            addSection('layout');
        }

        // Close modals on outside click
        document.getElementById('sectionModal').addEventListener('click', (e) => {
            if (e.target.id === 'sectionModal') closeSectionModal();
        });
        document.getElementById('qrModal').addEventListener('click', (e) => {
            if (e.target.id === 'qrModal') closeQRModal();
        });
        document.getElementById('mobilePreviewModal').addEventListener('click', (e) => {
            if (e.target.id === 'mobilePreviewModal') closeMobilePreview();
        });

        // Run initialization
        initializeLayout();
    </script>
</body>
</html>
