<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Portfolio Creator - InviteGen</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50 border-b">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <a href="index.html" class="text-2xl hover:scale-110 transition-transform">üé®</a>
                    <div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent">
                            InviteGen
                        </h1>
                        <p class="text-xs text-gray-500">Business Portfolio</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button onclick="previewFullscreen()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition">
                        üëÅÔ∏è Preview
                    </button>
                    <button onclick="generateQR()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-medium transition">
                        üì± QR Code
                    </button>
                    <button onclick="publishProject()" class="px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg text-sm font-medium hover:shadow-lg transition">
                        üöÄ Publish
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="flex h-[calc(100vh-73px)]">
        <!-- Left Panel - Editor -->
        <div class="w-full lg:w-5/12 bg-white border-r overflow-y-auto">
            <div class="p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Design Your Business Portfolio</h2>
                    <p class="text-sm text-gray-600 mt-1">Showcase your work professionally</p>
                </div>

                <!-- Sections Container -->
                <div id="sectionsContainer" class="space-y-4">
                    <!-- Sections will be added here dynamically -->
                </div>

                <!-- Add Section Button -->
                <button onclick="openSectionModal()" class="w-full mt-6 py-4 border-2 border-dashed border-gray-300 rounded-xl text-blue-600 font-semibold hover:border-blue-400 hover:bg-blue-50 transition flex items-center justify-center gap-2">
                    <span class="text-xl">+</span>
                    Add Section
                </button>
            </div>
        </div>

        <!-- Right Panel - Preview -->
        <div class="hidden lg:flex w-7/12 bg-gradient-to-br from-gray-100 to-gray-200 p-8 overflow-y-auto justify-center">
            <div class="h-fit">
                <div class="flex justify-between items-center mb-6 max-w-md mx-auto">
                    <h3 class="text-lg font-semibold text-gray-700">Live Preview</h3>
                    <div class="flex gap-2">
                        <button onclick="setDevice('mobile')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition device-btn active" data-device="mobile">
                            üì±
                        </button>
                        <button onclick="setDevice('tablet')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition device-btn" data-device="tablet">
                            üíª
                        </button>
                    </div>
                </div>

                <!-- Mobile Frame -->
                <div id="mobileFrame" class="w-[375px] h-[667px] bg-gray-900 rounded-[36px] p-3 shadow-2xl mx-auto">
                    <div class="w-full h-full bg-white rounded-[28px] overflow-y-auto" id="previewContent">
                        <div class="flex items-center justify-center h-full text-center p-8">
                            <div>
                                <div class="text-6xl mb-4">üíº</div>
                                <h3 class="text-xl font-bold text-gray-900 mb-2">Start Creating</h3>
                                <p class="text-gray-600 text-sm">Add sections to build your business portfolio</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

                <!-- Add Section Modal -->
    <div id="sectionModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
            <!-- Header -->
            <div class="p-6 border-b flex justify-between items-center bg-white">
                <h3 class="text-2xl font-bold">Add New Section</h3>
                <button onclick="closeSectionModal()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
            </div>

            <!-- Tab Navigation -->
            <div class="border-b flex bg-gray-50">
                <button class="flex-1 px-6 py-4 text-sm font-medium modal-tab-btn active" onclick="switchModalTab(event, 'most-used')">
                    ‚≠ê Most Used
                </button>
                <button class="flex-1 px-6 py-4 text-sm font-medium modal-tab-btn" onclick="switchModalTab(event, 'more')">
                    ‚ûï More Sections
                </button>
            </div>

            <!-- Tab Content Container -->
            <div class="overflow-y-auto flex-1">
                <!-- Most Used Tab -->
                <div class="modal-tab-content p-6" data-modal-tab="most-used">
                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <button data-section-type="hero" onclick="addSection('hero')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üíº</div>
                            <div class="font-semibold text-sm">Hero Banner</div>
                        </button>
                        <button data-section-type="about" onclick="addSection('about')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">‚ÑπÔ∏è</div>
                            <div class="font-semibold text-sm">About Us</div>
                        </button>
                        <button data-section-type="services" onclick="addSection('services')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">‚öôÔ∏è</div>
                            <div class="font-semibold text-sm">Services</div>
                        </button>
                        <button data-section-type="portfolio" onclick="addSection('portfolio')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üìÅ</div>
                            <div class="font-semibold text-sm">Portfolio</div>
                        </button>
                        <button data-section-type="contact" onclick="addSection('contact')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üìû</div>
                            <div class="font-semibold text-sm">Contact</div>
                        </button>
                    </div>
                </div>

                <!-- More Sections Tab -->
                <div class="modal-tab-content p-6 hidden" data-modal-tab="more">
                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <button data-section-type="team" onclick="addSection('team')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üë•</div>
                            <div class="font-semibold text-sm">Team</div>
                        </button>
                        <button data-section-type="testimonials" onclick="addSection('testimonials')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üí¨</div>
                            <div class="font-semibold text-sm">Testimonials</div>
                        </button>
                        <button data-section-type="social" onclick="addSection('social')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üîó</div>
                            <div class="font-semibold text-sm">Social Media</div>
                        </button>
                        <button data-section-type="cta" onclick="addSection('cta')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üéØ</div>
                            <div class="font-semibold text-sm">Call to Action</div>
                        </button>
                        <button data-section-type="skills" onclick="addSection('skills')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üéì</div>
                            <div class="font-semibold text-sm">Skills & Expertise</div>
                        </button>
                        <button data-section-type="pricing" onclick="addSection('pricing')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üí∞</div>
                            <div class="font-semibold text-sm">Pricing Plans</div>
                        </button>
                        <button data-section-type="faq" onclick="addSection('faq')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">‚ùì</div>
                            <div class="font-semibold text-sm">FAQ</div>
                        </button>
                        <button data-section-type="stats" onclick="addSection('stats')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üìä</div>
                            <div class="font-semibold text-sm">Statistics</div>
                        </button>
                        <button data-section-type="gallery" onclick="addSection('gallery')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üñºÔ∏è</div>
                            <div class="font-semibold text-sm">Gallery</div>
                        </button>
                        <button data-section-type="clients" onclick="addSection('clients')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">ü§ù</div>
                            <div class="font-semibold text-sm">Clients & Partners</div>
                        </button>
                        <button data-section-type="awards" onclick="addSection('awards')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üèÜ</div>
                            <div class="font-semibold text-sm">Awards</div>
                        </button>
                        <button data-section-type="video" onclick="addSection('video')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üé•</div>
                            <div class="font-semibold text-sm">Video</div>
                        </button>
                        <button data-section-type="features" onclick="addSection('features')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">‚ú®</div>
                            <div class="font-semibold text-sm">Features</div>
                        </button>
                        <button data-section-type="process" onclick="addSection('process')" class="p-6 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition text-center">
                            <div class="text-4xl mb-2">üîÑ</div>
                            <div class="font-semibold text-sm">Process</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Preview Button (Mobile Only) -->
    <button onclick="openMobilePreview()" class="lg:hidden fixed bottom-6 right-6 z-40 w-14 h-14 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-full shadow-lg hover:shadow-xl transition flex items-center justify-center text-2xl">
        üëÅÔ∏è
    </button>

    <!-- Mobile Preview Modal -->
    <div id="mobilePreviewModal" class="hidden fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center p-4">
        <div class="w-full h-full flex flex-col">
            <!-- Modal Header -->
            <div class="flex justify-between items-center mb-4 px-2">
                <h3 class="text-lg font-semibold text-white">Live Preview</h3>
                <button onclick="closeMobilePreview()" class="text-white hover:text-gray-300 text-3xl w-10 h-10 flex items-center justify-center">√ó</button>
            </div>

            <!-- Device Toggle -->
            <div class="flex gap-2 justify-center mb-4">
                <button onclick="setMobilePreviewDevice('mobile')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition mobile-preview-device-btn active" data-device="mobile">
                    üì± Mobile
                </button>
                <button onclick="setMobilePreviewDevice('tablet')" class="p-2 bg-white rounded-lg shadow-sm hover:shadow transition mobile-preview-device-btn" data-device="tablet">
                    üíª Tablet
                </button>
            </div>

            <!-- Mobile Frame -->
            <div class="flex-1 flex items-center justify-center overflow-auto">
                <div id="mobilePreviewFrame" class="w-[375px] h-[667px] bg-gray-900 rounded-[36px] p-3 shadow-2xl">
                    <div class="w-full h-full bg-white rounded-[28px] overflow-y-auto" id="mobilePreviewContent">
                        <!-- Preview content will be copied here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Modal -->
    <div id="qrModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-8">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">QR Code Generated</h3>
                <button onclick="closeQRModal()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
            </div>
            <div class="text-center">
                <div class="w-64 h-64 mx-auto bg-gray-100 rounded-lg flex items-center justify-center mb-4">
                    <div class="text-center">
                        <div class="text-5xl mb-2">üì±</div>
                        <div class="text-sm text-gray-600">QR Code</div>
                    </div>
                </div>
                <div class="bg-gray-50 p-3 rounded-lg mb-4 font-mono text-sm break-all" id="shareUrl">
                    https://invitegen.com/view/business123
                </div>
                <button onclick="copyUrl()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                    üìã Copy URL
                </button>
            </div>
        </div>
    </div>

    <script>
        let sectionCounter = 0;

        const sectionTemplates = {
            layout: {
                name: 'üé® Page Layout',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div class="border-b pb-4 mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Navigation Layout Type</label>
                            <div class="space-y-2">
                                <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="navType" value="none" class="section-data" data-field="navType" onchange="toggleNavigationSettings(this); updatePreview()" checked>
                                    <div>
                                        <div class="font-medium text-sm">No Navigation</div>
                                        <div class="text-xs text-gray-600">Standard scrolling layout</div>
                                    </div>
                                </label>
                                <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="navType" value="tabview" class="section-data" data-field="navType" onchange="toggleNavigationSettings(this); updatePreview()">
                                    <div>
                                        <div class="font-medium text-sm">üìë Tab View</div>
                                        <div class="text-xs text-gray-600">Organize sections into tabs</div>
                                    </div>
                                </label>
                                <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="navType" value="topnav" class="section-data" data-field="navType" onchange="toggleNavigationSettings(this); updatePreview()">
                                    <div>
                                        <div class="font-medium text-sm">üß≠ Top Navigation Bar</div>
                                        <div class="text-xs text-gray-600">Fixed navigation bar at the top</div>
                                    </div>
                                </label>
                                <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                                    <input type="radio" name="navType" value="bottomnav" class="section-data" data-field="navType" onchange="toggleNavigationSettings(this); updatePreview()">
                                    <div>
                                        <div class="font-medium text-sm">‚¨áÔ∏è Bottom Navigation Bar</div>
                                        <div class="text-xs text-gray-600">Fixed navigation bar at the bottom</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Tab View Settings -->
                        <div id="tabViewSettings" class="space-y-4 hidden">
                            <h4 class="text-sm font-semibold text-gray-700 border-b pb-2">Tab View Configuration</h4>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tab Names (one per line)</label>
                                <textarea placeholder="Home&#10;About&#10;Services&#10;Contact" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="tabNames" oninput="updatePreview(); updateSectionNavigationDropdowns()"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Define the tab names that will be available</p>
                            </div>
                            <div class="border-t pt-4">
                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Tab Layout Style</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tab Style</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="tabStyle" onchange="updatePreview()">
                                            <option value="underline" selected>Underline</option>
                                            <option value="pills">Pills</option>
                                            <option value="buttons">Buttons</option>
                                            <option value="boxed">Boxed</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tab Alignment</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="tabAlignment" onchange="updatePreview()">
                                            <option value="left" selected>Left</option>
                                            <option value="center">Center</option>
                                            <option value="right">Right</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tab Size</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="tabSize" onchange="updatePreview()">
                                            <option value="small">Small</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="large">Large</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Top Navigation Settings -->
                        <div id="topNavSettings" class="space-y-4 hidden">
                            <h4 class="text-sm font-semibold text-gray-700 border-b pb-2">Top Navigation Bar Configuration</h4>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Items (one per line)</label>
                                <textarea placeholder="Home&#10;About&#10;Services&#10;Contact" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="navItems" oninput="updatePreview(); updateSectionNavigationDropdowns()"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Define the navigation menu items</p>
                            </div>
                            <div class="border-t pt-4">
                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Navigation Bar Style</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Style</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="navStyle" onchange="updatePreview()">
                                            <option value="simple" selected>Simple</option>
                                            <option value="underline">Underline Active</option>
                                            <option value="pills">Pills</option>
                                            <option value="bordered">Bordered</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Alignment</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="navAlignment" onchange="updatePreview()">
                                            <option value="left" selected>Left</option>
                                            <option value="center">Center</option>
                                            <option value="right">Right</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Size</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="navSize" onchange="updatePreview()">
                                            <option value="small">Small</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="large">Large</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navbar Background</label>
                                        <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-data" data-field="navBgColor" oninput="updatePreview()">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navbar Text Color</label>
                                        <input type="color" value="#1f2937" class="w-full h-12 rounded-lg cursor-pointer section-data" data-field="navTextColor" oninput="updatePreview()">
                                    </div>
                                    <div>
                                        <label class="flex items-center gap-2">
                                            <input type="checkbox" class="w-5 h-5 rounded section-data" data-field="navSticky" onchange="updatePreview()" checked>
                                            <span class="text-sm font-medium text-gray-700">Sticky Navigation (fixed at top)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bottom Navigation Settings -->
                        <div id="bottomNavSettings" class="space-y-4 hidden">
                            <h4 class="text-sm font-semibold text-gray-700 border-b pb-2">Bottom Navigation Bar Configuration</h4>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Items (one per line)</label>
                                <textarea placeholder="Home&#10;About&#10;Services&#10;Contact" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="bottomNavItems" oninput="updatePreview(); updateSectionNavigationDropdowns()"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Define the navigation menu items</p>
                            </div>
                            <div class="border-t pt-4">
                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Navigation Bar Style</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Style</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="bottomNavStyle" onchange="updatePreview()">
                                            <option value="simple" selected>Simple</option>
                                            <option value="underline">Underline Active</option>
                                            <option value="pills">Pills</option>
                                            <option value="bordered">Bordered</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Alignment</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="bottomNavAlignment" onchange="updatePreview()">
                                            <option value="left" selected>Left</option>
                                            <option value="center">Center</option>
                                            <option value="right">Right</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Size</label>
                                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="bottomNavSize" onchange="updatePreview()">
                                            <option value="small">Small</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="large">Large</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navbar Background</label>
                                        <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-data" data-field="bottomNavBgColor" oninput="updatePreview()">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Navbar Text Color</label>
                                        <input type="color" value="#1f2937" class="w-full h-12 rounded-lg cursor-pointer section-data" data-field="bottomNavTextColor" oninput="updatePreview()">
                                    </div>
                                    <div>
                                        <label class="flex items-center gap-2">
                                            <input type="checkbox" class="w-5 h-5 rounded section-data" data-field="bottomNavSticky" onchange="updatePreview()" checked>
                                            <span class="text-sm font-medium text-gray-700">Sticky Navigation (fixed at bottom)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="text-sm text-gray-600 pt-4 border-t">
                            <p>This section controls the overall styling and appearance of your entire portfolio page.</p>
                            <p class="mt-2">Use the <strong>Style</strong> tab to customize colors, fonts, and layout.</p>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                            <input type="color" value="#9333ea" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="primaryColor" oninput="updatePreview()">
                            <p class="text-xs text-gray-500 mt-1">Used for headings and accents</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Secondary Color</label>
                            <input type="color" value="#ec4899" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="secondaryColor" oninput="updatePreview()">
                            <p class="text-xs text-gray-500 mt-1">Used for secondary elements</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bgColor" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#1f2937" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="textColor" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Font Family</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="fontFamily" onchange="updatePreview()">
                                <option value="system-ui, -apple-system, sans-serif">System Default</option>
                                <option value="Georgia, serif">Georgia (Serif)</option>
                                <option value="'Times New Roman', serif">Times New Roman</option>
                                <option value="'Courier New', monospace">Courier New</option>
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="'Comic Sans MS', cursive">Comic Sans</option>
                                <option value="'Brush Script MT', cursive">Brush Script</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Border Radius</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="borderRadius" onchange="updatePreview()">
                                <option value="0px">Square (No Radius)</option>
                                <option value="4px">Small (4px)</option>
                                <option value="8px" selected>Medium (8px)</option>
                                <option value="16px">Large (16px)</option>
                                <option value="24px">Extra Large (24px)</option>
                                <option value="9999px">Pill Shape</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Spacing</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 section-style" data-style="spacing" onchange="updatePreview()">
                                <option value="compact">Compact</option>
                                <option value="normal" selected>Normal</option>
                                <option value="relaxed">Relaxed</option>
                                <option value="spacious">Spacious</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => '' // Layout section doesn't render visible content
            },
            hero: {
                name: 'üíº Hero Banner',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Business Name</label>
                            <input type="text" placeholder="Your Business Name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent section-data" data-field="name" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tagline</label>
                            <input type="text" placeholder="Your business tagline" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent section-data" data-field="tagline" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hero Image</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 cursor-pointer" onclick="this.querySelector('input').click()">
                                <div class="text-3xl mb-2">üì∏</div>
                                <div class="text-sm text-gray-600">Click to upload</div>
                                <input type="file" class="hidden section-data" data-field="image" accept="image/*" onchange="handleImageUpload(this)">
                            </div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#2563eb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="text" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="text-center py-16 px-6" style="background: ${style.bg || '#2563eb'}; color: ${style.text || '#ffffff'}">
                        ${data.image ? `<img src="${data.image}" class="w-24 h-24 rounded-lg mx-auto mb-6 object-cover border-4 border-white">` : '<div class="text-6xl mb-6">üíº</div>'}
                        <h1 class="text-3xl font-bold mb-2">${data.name || 'Business Name'}</h1>
                        <p class="text-lg opacity-90">${data.tagline || 'Your professional tagline'}</p>
                    </div>
                `
            },
            about: {
                name: '‚ÑπÔ∏è About Us',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="About Us" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea placeholder="Tell your business story..." rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="description" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                        <div class="max-w-md mx-auto">
                            <h2 class="text-2xl font-bold text-center mb-6">${data.title || 'About Us'}</h2>
                            <p class="text-gray-600 leading-relaxed text-center">${data.description || 'Tell your business story here...'}</p>
                        </div>
                    </div>
                `
            },
            services: {
                name: '‚öôÔ∏è Services',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Services" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Services (one per line)</label>
                            <textarea placeholder="Web Development&#10;Mobile Apps&#10;Consulting&#10;Design Services" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="services" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#eff6ff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const services = data.services ? data.services.split('\n').filter(s => s.trim()) : [];
                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#eff6ff'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Services'}</h2>
                            <div class="max-w-md mx-auto space-y-3">
                                ${services.map(service => `
                                    <div class="flex items-center gap-3 p-4 bg-white rounded-lg">
                                        <div class="text-xl">‚úì</div>
                                        <div class="text-sm font-medium">${service}</div>
                                    </div>
                                `).join('')}
                                ${services.length === 0 ? '<div class="text-center text-gray-500 text-sm">Add services to display</div>' : ''}
                            </div>
                        </div>
                    `;
                }
            },
            portfolio: {
                name: 'üìÅ Portfolio',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Work" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Portfolio Images</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 cursor-pointer">
                                <div class="text-3xl mb-2">üñºÔ∏è</div>
                                <div class="text-sm text-gray-600">Click to upload multiple images</div>
                            </div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                        <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Work'}</h2>
                        <div class="max-w-md mx-auto text-center">
                            <div class="text-5xl mb-4">üìÅ</div>
                            <p class="text-gray-500 text-sm">Portfolio items will appear here</p>
                        </div>
                    </div>
                `
            },
            team: {
                name: 'üë• Team',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Meet Our Team" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Team Members (Name - Role, one per line)</label>
                            <textarea placeholder="John Smith - CEO&#10;Jane Doe - Lead Designer&#10;Mike Johnson - Developer" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="members" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f9fafb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const members = data.members ? data.members.split('\n').filter(m => m.trim()) : [];
                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#f9fafb'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Meet Our Team'}</h2>
                            <div class="max-w-md mx-auto space-y-4">
                                ${members.map(member => {
                                    const [name, role] = member.split('-').map(s => s.trim());
                                    return `
                                        <div class="p-4 bg-white rounded-lg text-center">
                                            <div class="text-3xl mb-2">üë§</div>
                                            <div class="font-semibold">${name || member}</div>
                                            ${role ? `<div class="text-sm text-gray-600">${role}</div>` : ''}
                                        </div>
                                    `;
                                }).join('')}
                                ${members.length === 0 ? '<div class="text-center text-gray-500 text-sm">Add team members to display</div>' : ''}
                            </div>
                        </div>
                    `;
                }
            },
            testimonials: {
                name: 'üí¨ Testimonials',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="What Clients Say" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Testimonial</label>
                            <textarea placeholder="Add a client testimonial..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="testimonial" oninput="updatePreview()"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Name</label>
                            <input type="text" placeholder="Client Name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="client" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                        <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'What Clients Say'}</h2>
                        <div class="max-w-md mx-auto">
                            <div class="p-6 bg-blue-50 rounded-lg">
                                <div class="text-3xl mb-3 text-center">üí¨</div>
                                <p class="text-gray-700 italic text-center mb-4">"${data.testimonial || 'Add a client testimonial...'}"</p>
                                <div class="text-center font-semibold text-sm">- ${data.client || 'Client Name'}</div>
                            </div>
                        </div>
                    </div>
                `
            },
            contact: {
                name: 'üìû Contact',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Get In Touch" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" placeholder="contact@business.com" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="email" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                            <input type="tel" placeholder="+1 234 567 8900" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="phone" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                            <textarea placeholder="Business address..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="address" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#eff6ff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6" style="background: ${style.bg || '#eff6ff'}">
                        <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Get In Touch'}</h2>
                        <div class="max-w-md mx-auto space-y-4">
                            ${data.email ? `
                            <div class="flex items-center gap-4 p-4 bg-white rounded-lg">
                                <div class="text-2xl">üìß</div>
                                <div>
                                    <div class="text-xs text-gray-500 mb-1">Email</div>
                                    <div class="font-medium text-sm">${data.email}</div>
                                </div>
                            </div>` : ''}
                            ${data.phone ? `
                            <div class="flex items-center gap-4 p-4 bg-white rounded-lg">
                                <div class="text-2xl">üìû</div>
                                <div>
                                    <div class="text-xs text-gray-500 mb-1">Phone</div>
                                    <div class="font-medium text-sm">${data.phone}</div>
                                </div>
                            </div>` : ''}
                            ${data.address ? `
                            <div class="flex items-start gap-4 p-4 bg-white rounded-lg">
                                <div class="text-2xl">üìç</div>
                                <div>
                                    <div class="text-xs text-gray-500 mb-1">Address</div>
                                    <div class="font-medium text-sm">${data.address}</div>
                                </div>
                            </div>` : ''}
                        </div>
                    </div>
                `
            },
            social: {
                name: 'üîó Social Media',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Follow Us" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Facebook URL</label>
                            <input type="url" placeholder="https://facebook.com/..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="facebook" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Instagram URL</label>
                            <input type="url" placeholder="https://instagram.com/..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="instagram" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">LinkedIn URL</label>
                            <input type="url" placeholder="https://linkedin.com/..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="linkedin" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6 text-center" style="background: ${style.bg || '#ffffff'}">
                        <div class="max-w-md mx-auto">
                            <h2 class="text-2xl font-bold mb-6">${data.title || 'Follow Us'}</h2>
                            <div class="flex justify-center gap-4">
                                ${data.facebook ? `<a href="${data.facebook}" class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center text-xl">f</a>` : ''}
                                ${data.instagram ? `<a href="${data.instagram}" class="w-12 h-12 bg-pink-600 text-white rounded-full flex items-center justify-center text-xl">üì∑</a>` : ''}
                                ${data.linkedin ? `<a href="${data.linkedin}" class="w-12 h-12 bg-blue-700 text-white rounded-full flex items-center justify-center text-xl">in</a>` : ''}
                            </div>
                            ${!data.facebook && !data.instagram && !data.linkedin ? '<p class="text-gray-500 text-sm">Add social media links</p>' : ''}
                        </div>
                    </div>
                `
            },
            cta: {
                name: 'üéØ Call to Action',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Heading</label>
                            <input type="text" placeholder="Ready to Work Together?" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="heading" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Subtext</label>
                            <input type="text" placeholder="Let's bring your ideas to life" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="subtext" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Button Text</label>
                            <input type="text" placeholder="Get Started" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="button" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#2563eb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="text" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-16 px-6 text-center" style="background: ${style.bg || '#2563eb'}; color: ${style.text || '#ffffff'}">
                        <div class="max-w-md mx-auto">
                            <h2 class="text-2xl font-bold mb-3">${data.heading || 'Ready to Work Together?'}</h2>
                            <p class="text-lg opacity-90 mb-6">${data.subtext || "Let's bring your ideas to life"}</p>
                            <button class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                                ${data.button || 'Get Started'}
                            </button>
                        </div>
                    </div>
                `
            },
            skills: {
                name: 'üéì Skills & Expertise',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Expertise" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Skills (one per line with optional percentage)</label>
                            <textarea placeholder="Web Development - 95%&#10;Mobile Apps - 90%&#10;UI/UX Design - 85%&#10;Cloud Services - 80%" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="skills" oninput="updatePreview()"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Format: Skill Name - Percentage (or just Skill Name)</p>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f9fafb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Progress Bar Color</label>
                            <input type="color" value="#2563eb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="barColor" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const skills = (data.skills || '').split('\n').filter(s => s.trim());
                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#f9fafb'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Expertise'}</h2>
                            <div class="max-w-2xl mx-auto space-y-6">
                                ${skills.map(skill => {
                                    const match = skill.match(/(.+?)\s*-\s*(\d+)%?/);
                                    if (match) {
                                        const [, name, percentage] = match;
                                        return `
                                            <div>
                                                <div class="flex justify-between mb-2">
                                                    <span class="font-medium text-sm">${name.trim()}</span>
                                                    <span class="text-sm text-gray-600">${percentage}%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                                    <div class="h-2.5 rounded-full" style="width: ${percentage}%; background: ${style.barColor || '#2563eb'}"></div>
                                                </div>
                                            </div>
                                        `;
                                    } else {
                                        return `
                                            <div class="flex items-center gap-3">
                                                <div class="w-2 h-2 rounded-full" style="background: ${style.barColor || '#2563eb'}"></div>
                                                <span class="font-medium text-sm">${skill.trim()}</span>
                                            </div>
                                        `;
                                    }
                                }).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            pricing: {
                name: 'üí∞ Pricing Plans',
                allowMultiple: false,
                info: (sectionId) => `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Pricing Plans" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="border-t pt-4 mt-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium text-gray-700">Plans</h4>
                                <button onclick="addDynamicItem('${sectionId}', 'plans', (id, num) => \`
                                    <div class='flex justify-between items-center mb-3'>
                                        <h5 class='font-medium text-gray-600'>Plan \${num}</h5>
                                        <button onclick='removeDynamicItem(this)' class='text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50'>‚úï Remove</button>
                                    </div>
                                    <div class='space-y-3'>
                                        <input type='text' placeholder='Plan Name' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='plan-name-\${id}' oninput='updatePreview()'>
                                        <input type='text' placeholder='$99/mo' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='plan-price-\${id}' oninput='updatePreview()'>
                                        <textarea placeholder='Feature 1\nFeature 2\nFeature 3' rows='3' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='plan-features-\${id}' oninput='updatePreview()'></textarea>
                                    </div>
                                \`); return false;" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition">+ Add Plan</button>
                            </div>
                            <div data-items-container="plans"></div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Border Color</label>
                            <input type="color" value="#e5e7eb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="borderColor" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const plans = [];
                    Object.keys(data).forEach(key => {
                        const match = key.match(/^plan-name-(.+)$/);
                        if (match) {
                            const id = match[1];
                            plans.push({
                                name: data[`plan-name-${id}`],
                                price: data[`plan-price-${id}`],
                                features: data[`plan-features-${id}`]
                            });
                        }
                    });

                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Pricing Plans'}</h2>
                            <div class="max-w-5xl mx-auto grid md:grid-cols-${plans.length} gap-6">
                                ${plans.map((plan, idx) => `
                                    <div class="border-2 rounded-xl p-6 ${idx === 1 ? 'border-blue-600 shadow-lg' : ''}" style="border-color: ${idx === 1 ? '#2563eb' : style.borderColor || '#e5e7eb'}">
                                        ${idx === 1 ? '<div class="text-xs font-semibold text-blue-600 text-center mb-2">MOST POPULAR</div>' : ''}
                                        <div class="text-center mb-6">
                                            <h3 class="text-xl font-bold mb-2">${plan.name || 'Plan'}</h3>
                                            <div class="text-3xl font-bold text-blue-600">${plan.price || '$0'}</div>
                                        </div>
                                        <div class="space-y-3">
                                            ${(plan.features || '').split('\n').filter(f => f.trim()).map(feature => `
                                                <div class="flex items-center gap-2">
                                                    <div class="text-green-600">‚úì</div>
                                                    <div class="text-sm">${feature.trim()}</div>
                                                </div>
                                            `).join('')}
                                        </div>
                                        <button class="w-full mt-6 py-2 px-4 rounded-lg font-medium ${idx === 1 ? 'bg-blue-600 text-white' : 'border-2 border-gray-300 text-gray-700'}">
                                            Choose Plan
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            faq: {
                name: '‚ùì FAQ',
                allowMultiple: false,
                info: (sectionId) => `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Frequently Asked Questions" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="border-t pt-4 mt-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium text-gray-700">Questions</h4>
                                <button onclick="addDynamicItem('${sectionId}', 'faqs', (id, num) => \`
                                    <div class='flex justify-between items-center mb-3'>
                                        <h5 class='font-medium text-gray-600'>Question \${num}</h5>
                                        <button onclick='removeDynamicItem(this)' class='text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50'>‚úï Remove</button>
                                    </div>
                                    <div class='space-y-3'>
                                        <input type='text' placeholder='Question' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='faq-q-\${id}' oninput='updatePreview()'>
                                        <textarea placeholder='Answer...' rows='2' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='faq-a-\${id}' oninput='updatePreview()'></textarea>
                                    </div>
                                \`); return false;" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition">+ Add Question</button>
                            </div>
                            <div data-items-container="faqs"></div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f9fafb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const faqs = [];
                    Object.keys(data).forEach(key => {
                        const match = key.match(/^faq-q-(.+)$/);
                        if (match) {
                            const id = match[1];
                            faqs.push({
                                q: data[`faq-q-${id}`],
                                a: data[`faq-a-${id}`]
                            });
                        }
                    });

                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#f9fafb'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Frequently Asked Questions'}</h2>
                            <div class="max-w-3xl mx-auto space-y-4">
                                ${faqs.map(faq => `
                                    <div class="bg-white rounded-lg p-6 shadow-sm">
                                        <h3 class="font-semibold text-lg mb-2">${faq.q || 'Question'}</h3>
                                        <p class="text-gray-600 text-sm">${faq.a || 'Answer'}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            stats: {
                name: 'üìä Statistics',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Achievements" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 1 Value</label>
                                <input type="text" placeholder="500+" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat1Value" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 1 Label</label>
                                <input type="text" placeholder="Projects" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat1Label" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 2 Value</label>
                                <input type="text" placeholder="200+" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat2Value" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 2 Label</label>
                                <input type="text" placeholder="Clients" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat2Label" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 3 Value</label>
                                <input type="text" placeholder="15+" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat3Value" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 3 Label</label>
                                <input type="text" placeholder="Years" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat3Label" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 4 Value</label>
                                <input type="text" placeholder="98%" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat4Value" oninput="updatePreview()">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Stat 4 Label</label>
                                <input type="text" placeholder="Satisfaction" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="stat4Label" oninput="updatePreview()">
                            </div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#1e40af" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Text Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="textColor" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const stats = [
                        { value: data.stat1Value, label: data.stat1Label },
                        { value: data.stat2Value, label: data.stat2Label },
                        { value: data.stat3Value, label: data.stat3Label },
                        { value: data.stat4Value, label: data.stat4Label }
                    ].filter(s => s.value || s.label);

                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#1e40af'}; color: ${style.textColor || '#ffffff'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Achievements'}</h2>
                            <div class="max-w-4xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-6">
                                ${stats.map(stat => `
                                    <div class="text-center">
                                        <div class="text-3xl font-bold mb-2">${stat.value || '0'}</div>
                                        <div class="text-sm opacity-90">${stat.label || 'Stat'}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            gallery: {
                name: 'üñºÔ∏è Gallery',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Work" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Image Titles (one per line)</label>
                            <textarea placeholder="Project Alpha&#10;Project Beta&#10;Project Gamma&#10;Project Delta&#10;Project Epsilon&#10;Project Zeta" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="images" oninput="updatePreview()"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Each line represents one image in the gallery</p>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Grid Layout</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-style" data-style="columns" onchange="updatePreview()">
                                <option value="2">2 Columns</option>
                                <option value="3" selected>3 Columns</option>
                                <option value="4">4 Columns</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const images = (data.images || '').split('\n').filter(i => i.trim());
                    const columns = style.columns || '3';
                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Work'}</h2>
                            <div class="max-w-6xl mx-auto grid grid-cols-2 md:grid-cols-${columns} gap-4">
                                ${images.map(image => `
                                    <div class="aspect-square bg-gradient-to-br from-blue-100 to-cyan-100 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition flex items-center justify-center">
                                        <div class="text-center p-4">
                                            <div class="text-4xl mb-2">üñºÔ∏è</div>
                                            <div class="text-sm font-medium text-gray-700">${image.trim()}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            clients: {
                name: 'ü§ù Clients & Partners',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Clients & Partners" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Client Names (one per line)</label>
                            <textarea placeholder="Company A&#10;Company B&#10;Company C&#10;Company D&#10;Company E&#10;Company F" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="clients" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f9fafb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Logo Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-style" data-style="logoStyle" onchange="updatePreview()">
                                <option value="boxes">Boxes</option>
                                <option value="circles" selected>Circles</option>
                                <option value="minimal">Minimal</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const clients = (data.clients || '').split('\n').filter(c => c.trim());
                    const logoStyle = style.logoStyle || 'circles';
                    const styleClasses = {
                        boxes: 'rounded-lg border-2 border-gray-200',
                        circles: 'rounded-full border-2 border-gray-200',
                        minimal: 'rounded'
                    };
                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#f9fafb'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Clients & Partners'}</h2>
                            <div class="max-w-5xl mx-auto grid grid-cols-3 md:grid-cols-6 gap-6">
                                ${clients.map(client => `
                                    <div class="flex items-center justify-center">
                                        <div class="w-20 h-20 bg-white ${styleClasses[logoStyle]} flex items-center justify-center p-3 hover:shadow-md transition">
                                            <div class="text-center">
                                                <div class="text-xs font-semibold text-gray-700 leading-tight">${client.trim()}</div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            awards: {
                name: 'üèÜ Awards',
                allowMultiple: false,
                info: (sectionId) => `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Awards & Recognition" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="border-t pt-4 mt-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium text-gray-700">Awards</h4>
                                <button onclick="addDynamicItem('${sectionId}', 'awards', (id, num) => \`
                                    <div class='flex justify-between items-center mb-3'>
                                        <h5 class='font-medium text-gray-600'>Award \${num}</h5>
                                        <button onclick='removeDynamicItem(this)' class='text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50'>‚úï Remove</button>
                                    </div>
                                    <div class='space-y-3'>
                                        <input type='text' placeholder='Award Name' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='award-name-\${id}' oninput='updatePreview()'>
                                        <input type='text' placeholder='Year' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='award-year-\${id}' oninput='updatePreview()'>
                                        <textarea placeholder='Description...' rows='2' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='award-desc-\${id}' oninput='updatePreview()'></textarea>
                                    </div>
                                \`); return false;" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition">+ Add Award</button>
                            </div>
                            <div data-items-container="awards"></div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#fffbeb" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const awards = [];
                    Object.keys(data).forEach(key => {
                        const match = key.match(/^award-name-(.+)$/);
                        if (match) {
                            const id = match[1];
                            awards.push({
                                name: data[`award-name-${id}`],
                                year: data[`award-year-${id}`],
                                desc: data[`award-desc-${id}`]
                            });
                        }
                    });

                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#fffbeb'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Awards & Recognition'}</h2>
                            <div class="max-w-4xl mx-auto space-y-6">
                                ${awards.map(award => `
                                    <div class="bg-white rounded-xl p-6 shadow-md hover:shadow-lg transition flex items-start gap-4">
                                        <div class="text-5xl">üèÜ</div>
                                        <div class="flex-1">
                                            <div class="flex items-baseline gap-3 mb-2">
                                                <h3 class="text-lg font-bold">${award.name || 'Award'}</h3>
                                                <span class="text-sm text-amber-600 font-semibold">${award.year || ''}</span>
                                            </div>
                                            ${award.desc ? `<p class="text-sm text-gray-600">${award.desc}</p>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            video: {
                name: 'üé• Video',
                allowMultiple: false,
                info: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Watch Our Story" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Video Title</label>
                            <input type="text" placeholder="Company Introduction" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="videoTitle" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Video URL (YouTube, Vimeo, etc.)</label>
                            <input type="url" placeholder="https://youtube.com/watch?v=..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="videoUrl" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea placeholder="Video description..." rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="description" oninput="updatePreview()"></textarea>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#000000" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                    </div>
                `,
                render: (data, style) => `
                    <div class="py-12 px-6" style="background: ${style.bg || '#000000'}">
                        <div class="max-w-4xl mx-auto">
                            <h2 class="text-2xl font-bold text-center mb-8 text-white">${data.title || 'Watch Our Story'}</h2>
                            <div class="bg-gray-900 rounded-xl overflow-hidden shadow-2xl">
                                <div class="aspect-video bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center">
                                    <div class="text-center">
                                        <div class="text-6xl mb-4">üé•</div>
                                        <div class="text-white font-semibold mb-2">${data.videoTitle || 'Video Player'}</div>
                                        ${data.videoUrl ? `<div class="text-xs text-gray-400">URL: ${data.videoUrl}</div>` : ''}
                                    </div>
                                </div>
                                ${data.description ? `
                                <div class="p-6 bg-gray-800">
                                    <p class="text-gray-300 text-sm">${data.description}</p>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `
            },
            features: {
                name: '‚ú® Features',
                allowMultiple: false,
                info: (sectionId) => `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Why Choose Us" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="border-t pt-4 mt-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium text-gray-700">Features</h4>
                                <button onclick="addDynamicItem('${sectionId}', 'features', (id, num) => \`
                                    <div class='flex justify-between items-center mb-3'>
                                        <h5 class='font-medium text-gray-600'>Feature \${num}</h5>
                                        <button onclick='removeDynamicItem(this)' class='text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50'>‚úï Remove</button>
                                    </div>
                                    <div class='space-y-3'>
                                        <input type='text' placeholder='Icon (emoji)' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='feature-icon-\${id}' oninput='updatePreview()'>
                                        <input type='text' placeholder='Feature Title' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='feature-title-\${id}' oninput='updatePreview()'>
                                        <textarea placeholder='Description...' rows='2' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='feature-desc-\${id}' oninput='updatePreview()'></textarea>
                                    </div>
                                \`); return false;" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition">+ Add Feature</button>
                            </div>
                            <div data-items-container="features"></div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#ffffff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-style" data-style="cardStyle" onchange="updatePreview()">
                                <option value="bordered">Bordered</option>
                                <option value="shadow" selected>Shadow</option>
                                <option value="filled">Filled</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const features = [];
                    Object.keys(data).forEach(key => {
                        const match = key.match(/^feature-icon-(.+)$/);
                        if (match) {
                            const id = match[1];
                            features.push({
                                icon: data[`feature-icon-${id}`],
                                title: data[`feature-title-${id}`],
                                desc: data[`feature-desc-${id}`]
                            });
                        }
                    });

                    const cardStyle = style.cardStyle || 'shadow';
                    const cardClasses = {
                        bordered: 'border-2 border-gray-200',
                        shadow: 'shadow-md hover:shadow-lg',
                        filled: 'bg-blue-50 border border-blue-100'
                    };

                    return `
                        <div class="py-12 px-6" style="background: ${style.bg || '#ffffff'}">
                            <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Why Choose Us'}</h2>
                            <div class="max-w-5xl mx-auto grid md:grid-cols-2 gap-6">
                                ${features.map(feature => `
                                    <div class="bg-white rounded-xl p-6 ${cardClasses[cardStyle]} transition">
                                        <div class="text-4xl mb-3">${feature.icon || '‚ú®'}</div>
                                        <h3 class="text-lg font-bold mb-2">${feature.title}</h3>
                                        ${feature.desc ? `<p class="text-sm text-gray-600">${feature.desc}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            },
            process: {
                name: 'üîÑ Process',
                allowMultiple: false,
                info: (sectionId) => `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Section Title</label>
                            <input type="text" placeholder="Our Process" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data" data-field="title" oninput="updatePreview()">
                        </div>
                        <div class="border-t pt-4 mt-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-medium text-gray-700">Steps</h4>
                                <button onclick="addDynamicItem('${sectionId}', 'steps', (id, num) => \`
                                    <div class='flex justify-between items-center mb-3'>
                                        <h5 class='font-medium text-gray-600'>Step \${num}</h5>
                                        <button onclick='removeDynamicItem(this)' class='text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50'>‚úï Remove</button>
                                    </div>
                                    <div class='space-y-3'>
                                        <input type='text' placeholder='Step Title' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='step-title-\${id}' oninput='updatePreview()'>
                                        <textarea placeholder='Step description...' rows='2' class='w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data' data-field='step-desc-\${id}' oninput='updatePreview()'></textarea>
                                    </div>
                                \`); return false;" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition">+ Add Step</button>
                            </div>
                            <div data-items-container="steps"></div>
                        </div>
                    </div>
                `,
                style: `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <input type="color" value="#f0f9ff" class="w-full h-12 rounded-lg cursor-pointer section-style" data-style="bg" oninput="updatePreview()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Layout Style</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-style" data-style="layout" onchange="updatePreview()">
                                <option value="vertical" selected>Vertical Timeline</option>
                                <option value="cards">Cards</option>
                            </select>
                        </div>
                    </div>
                `,
                render: (data, style) => {
                    const steps = [];
                    Object.keys(data).forEach(key => {
                        const match = key.match(/^step-title-(.+)$/);
                        if (match) {
                            const id = match[1];
                            steps.push({
                                title: data[`step-title-${id}`],
                                desc: data[`step-desc-${id}`]
                            });
                        }
                    });

                    const layout = style.layout || 'vertical';

                    if (layout === 'vertical') {
                        return `
                            <div class="py-12 px-6" style="background: ${style.bg || '#f0f9ff'}">
                                <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Process'}</h2>
                                <div class="max-w-3xl mx-auto space-y-6">
                                    ${steps.map((step, idx) => `
                                        <div class="flex gap-4">
                                            <div class="flex flex-col items-center">
                                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">${idx + 1}</div>
                                                ${idx < steps.length - 1 ? '<div class="w-0.5 flex-1 bg-blue-300 my-2"></div>' : ''}
                                            </div>
                                            <div class="flex-1 pb-6">
                                                <h3 class="text-lg font-bold mb-2">${step.title}</h3>
                                                ${step.desc ? `<p class="text-sm text-gray-600">${step.desc}</p>` : ''}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="py-12 px-6" style="background: ${style.bg || '#f0f9ff'}">
                                <h2 class="text-2xl font-bold text-center mb-8">${data.title || 'Our Process'}</h2>
                                <div class="max-w-5xl mx-auto grid md:grid-cols-2 gap-6">
                                    ${steps.map((step, idx) => `
                                        <div class="bg-white rounded-xl p-6 shadow-md">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">${idx + 1}</div>
                                                <h3 class="text-lg font-bold">${step.title}</h3>
                                            </div>
                                            ${step.desc ? `<p class="text-sm text-gray-600">${step.desc}</p>` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    }
                }
            }
        };

        function openSectionModal() {
            updateSectionAvailability();
            document.getElementById('sectionModal').classList.remove('hidden');
        }

        function updateSectionAvailability() {
            // Get all currently added sections
            const addedSections = {};
            document.querySelectorAll('.section-item').forEach(section => {
                const type = section.dataset.type;
                addedSections[type] = (addedSections[type] || 0) + 1;
            });

            // Update each section button in the modal
            document.querySelectorAll('[data-section-type]').forEach(button => {
                const type = button.dataset.sectionType;
                const template = sectionTemplates[type];

                if (!template) return;

                const isAdded = addedSections[type] > 0;
                const allowMultiple = template.allowMultiple !== false; // Default to true if not specified

                if (isAdded && !allowMultiple) {
                    // Disable button
                    button.disabled = true;
                    button.classList.add('opacity-50', 'cursor-not-allowed', 'bg-gray-100');
                    button.classList.remove('hover:border-purple-500', 'hover:bg-purple-50');

                    // Add "Added" badge
                    if (!button.querySelector('.added-badge')) {
                        const badge = document.createElement('span');
                        badge.className = 'added-badge absolute top-2 right-2 text-xs bg-green-500 text-white px-2 py-1 rounded';
                        badge.textContent = '‚úì Added';
                        button.style.position = 'relative';
                        button.appendChild(badge);
                    }
                } else {
                    // Enable button
                    button.disabled = false;
                    button.classList.remove('opacity-50', 'cursor-not-allowed', 'bg-gray-100');
                    button.classList.add('hover:border-purple-500', 'hover:bg-purple-50');

                    // Remove "Added" badge if it exists
                    const badge = button.querySelector('.added-badge');
                    if (badge) badge.remove();
                }
            });
        }

        
        function switchModalTab(event, tabName) {
            // Remove active class from all tab buttons
            document.querySelectorAll('.modal-tab-btn').forEach(btn => {
                btn.classList.remove('active', 'text-purple-600', 'border-b-2', 'border-purple-600', 'bg-white');
            });

            // Hide all tab contents
            document.querySelectorAll('.modal-tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            // Activate clicked tab button
            event.target.classList.add('active', 'text-purple-600', 'border-b-2', 'border-purple-600', 'bg-white');

            // Show corresponding tab content
            document.querySelector(`[data-modal-tab="${tabName}"]`).classList.remove('hidden');
        }

        function closeSectionModal() {
            document.getElementById('sectionModal').classList.add('hidden');
        }

        function addSection(type) {
            const template = sectionTemplates[type];
            const id = `section-${sectionCounter++}`;
            const isLayout = type === 'layout';
            const isHero = type === 'hero';

            // Check navigation type
            const layoutSection = document.querySelector('[data-type="layout"]');
            const navTypeRadio = layoutSection ? layoutSection.querySelector('[data-field="navType"]:checked') : null;
            const navType = navTypeRadio?.value || 'none';
            const navEnabled = navType !== 'none';

            // For layout and hero section when navigation is enabled, hide remove button
            const canRemove = !isLayout && !(isHero && navEnabled);
            const removeButton = canRemove ? `<button onclick="removeSection('${id}')" class="text-gray-400 hover:text-red-600 transition">‚úï</button>` : '';
            const dragHandle = isLayout ? '' : `<span class="cursor-move text-gray-400">‚ãÆ‚ãÆ</span>`;

            // Add navigation selector for non-hero, non-layout sections when navigation is enabled
            const navSelector = (!isLayout && !isHero && navEnabled) ? `
                <div class="px-4 pt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">${navType === 'tabview' ? 'Assign to Tab' : 'Assign to Navigation Item'}</label>
                    <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data nav-selector" data-field="assignedNavItem" onchange="updatePreview()">
                        <option value="">${navType === 'tabview' ? 'Select a tab...' : 'Select a navigation item...'}</option>
                    </select>
                </div>
            ` : '';

            const sectionHTML = `
                <div class="border border-gray-200 rounded-xl overflow-hidden section-item ${isLayout ? 'border-purple-300 bg-purple-50' : ''} ${isHero ? 'border-blue-300' : ''}" data-id="${id}" data-type="${type}" ${isLayout ? 'data-permanent="true"' : ''} ${(isHero && navEnabled) ? 'data-mandatory="true"' : ''}>
                    <div class="bg-gray-50 border-b px-4 py-3 flex justify-between items-center ${isLayout ? 'bg-purple-100' : ''} ${isHero ? 'bg-blue-50' : ''}">
                        <div class="flex items-center gap-2">
                            ${dragHandle}
                            <span class="font-semibold text-sm">${template.name}</span>
                            ${isLayout ? '<span class="ml-2 text-xs bg-purple-200 text-purple-700 px-2 py-1 rounded">Global Settings</span>' : ''}
                            ${(isHero && navEnabled) ? '<span class="ml-2 text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded">Mandatory</span>' : ''}
                        </div>
                        ${removeButton}
                    </div>
                    ${navSelector}
                    <div class="border-b flex">
                        <button class="flex-1 px-4 py-3 text-sm font-medium border-r tab-btn active" onclick="switchTab(event, '${id}', 'info')">
                            Info
                        </button>
                        <button class="flex-1 px-4 py-3 text-sm font-medium tab-btn" onclick="switchTab(event, '${id}', 'style')">
                            Style
                        </button>
                    </div>
                    <div class="p-4 tab-content" data-tab="info">
                        ${typeof template.info === 'function' ? template.info(id) : template.info}
                    </div>
                    <div class="p-4 tab-content hidden" data-tab="style">
                        ${template.style}
                    </div>
                </div>
            `;

            document.getElementById('sectionsContainer').insertAdjacentHTML('beforeend', sectionHTML);
            if (!isLayout) {
                closeSectionModal();
            }

            // Update navigation dropdowns for all sections
            updateSectionNavigationDropdowns();
            updatePreview();
        }

        function removeSection(id) {
            const section = document.querySelector(`[data-id="${id}"]`);
            if (section && section.dataset.mandatory === 'true') {
                alert('This section is mandatory and cannot be removed when tab view is enabled.');
                return;
            }
            if (confirm('Remove this section?')) {
                section.remove();
                updatePreview();
            }
        }

        function toggleNavigationSettings(radio) {
            const navType = radio.value;
            const tabViewSettings = document.getElementById('tabViewSettings');
            const topNavSettings = document.getElementById('topNavSettings');
            const bottomNavSettings = document.getElementById('bottomNavSettings');
            const heroSection = document.querySelector('[data-type="hero"]');

            // Hide all navigation settings first
            tabViewSettings.classList.add('hidden');
            topNavSettings.classList.add('hidden');
            bottomNavSettings.classList.add('hidden');

            // Remove all navigation selectors
            document.querySelectorAll('.nav-selector').forEach(selector => {
                selector.closest('div').remove();
            });

            // Reset hero section mandatory status
            if (heroSection) {
                heroSection.dataset.mandatory = 'false';
                const mandatoryBadge = heroSection.querySelector('.bg-blue-200');
                if (mandatoryBadge) mandatoryBadge.remove();
                heroSection.classList.remove('border-blue-300');
                const header = heroSection.querySelector('.bg-blue-50');
                if (header) header.classList.remove('bg-blue-50');

                // Add back remove button if it doesn't exist
                const headerDiv = heroSection.querySelector('.bg-gray-50');
                if (headerDiv && !headerDiv.querySelector('button[onclick^="removeSection"]')) {
                    const id = heroSection.dataset.id;
                    headerDiv.insertAdjacentHTML('beforeend', `<button onclick="removeSection('${id}')" class="text-gray-400 hover:text-red-600 transition">‚úï</button>`);
                }
            }

            if (navType === 'tabview') {
                // Show tab view settings
                tabViewSettings.classList.remove('hidden');

                // Make hero section mandatory
                if (heroSection) {
                    heroSection.dataset.mandatory = 'true';
                    const removeBtn = heroSection.querySelector('button[onclick^="removeSection"]');
                    if (removeBtn) removeBtn.remove();

                    // Add mandatory badge
                    const header = heroSection.querySelector('.bg-gray-50');
                    if (header && !header.querySelector('.bg-blue-200')) {
                        header.classList.add('bg-blue-50');
                        const titleDiv = header.querySelector('div');
                        titleDiv.insertAdjacentHTML('beforeend', '<span class="ml-2 text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded">Mandatory</span>');
                    }
                    heroSection.classList.add('border-blue-300');
                } else {
                    // Add hero section if it doesn't exist
                    addSection('hero');
                }

                // Add tab selectors to existing sections
                updateSectionNavigationDropdowns();
            } else if (navType === 'topnav') {
                // Show top navigation settings
                topNavSettings.classList.remove('hidden');

                // Make hero section mandatory
                if (heroSection) {
                    heroSection.dataset.mandatory = 'true';
                    const removeBtn = heroSection.querySelector('button[onclick^="removeSection"]');
                    if (removeBtn) removeBtn.remove();

                    // Add mandatory badge
                    const header = heroSection.querySelector('.bg-gray-50');
                    if (header && !header.querySelector('.bg-blue-200')) {
                        header.classList.add('bg-blue-50');
                        const titleDiv = header.querySelector('div');
                        titleDiv.insertAdjacentHTML('beforeend', '<span class="ml-2 text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded">Mandatory</span>');
                    }
                    heroSection.classList.add('border-blue-300');
                } else {
                    // Add hero section if it doesn't exist
                    addSection('hero');
                }

                // Add navigation item selectors to existing sections
                updateSectionNavigationDropdowns();
            } else if (navType === 'bottomnav') {
                // Show bottom navigation settings
                bottomNavSettings.classList.remove('hidden');

                // Make hero section mandatory
                if (heroSection) {
                    heroSection.dataset.mandatory = 'true';
                    const removeBtn = heroSection.querySelector('button[onclick^="removeSection"]');
                    if (removeBtn) removeBtn.remove();

                    // Add mandatory badge
                    const header = heroSection.querySelector('.bg-gray-50');
                    if (header && !header.querySelector('.bg-blue-200')) {
                        header.classList.add('bg-blue-50');
                        const titleDiv = header.querySelector('div');
                        titleDiv.insertAdjacentHTML('beforeend', '<span class="ml-2 text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded">Mandatory</span>');
                    }
                    heroSection.classList.add('border-blue-300');
                } else {
                    // Add hero section if it doesn't exist
                    addSection('hero');
                }

                // Add navigation item selectors to existing sections
                updateSectionNavigationDropdowns();
            }
        }

        function updateSectionNavigationDropdowns() {
            const layoutSection = document.querySelector('[data-type="layout"]');
            if (!layoutSection) return;

            // Get the selected navigation type
            const navTypeRadio = layoutSection.querySelector('[data-field="navType"]:checked');
            const navType = navTypeRadio?.value;

            if (!navType || navType === 'none') return;

            let navItems = [];
            let labelText = '';
            let placeholderText = '';

            if (navType === 'tabview') {
                const tabNamesTextarea = layoutSection.querySelector('[data-field="tabNames"]');
                navItems = tabNamesTextarea?.value.split('\n').filter(name => name.trim()) || [];
                labelText = 'Assign to Tab';
                placeholderText = 'Select a tab...';
            } else if (navType === 'topnav') {
                const navItemsTextarea = layoutSection.querySelector('[data-field="navItems"]');
                navItems = navItemsTextarea?.value.split('\n').filter(name => name.trim()) || [];
                labelText = 'Assign to Navigation Item';
                placeholderText = 'Select a navigation item...';
            } else if (navType === 'bottomnav') {
                const navItemsTextarea = layoutSection.querySelector('[data-field="bottomNavItems"]');
                navItems = navItemsTextarea?.value.split('\n').filter(name => name.trim()) || [];
                labelText = 'Assign to Navigation Item';
                placeholderText = 'Select a navigation item...';
            }

            // Update all navigation selector dropdowns
            document.querySelectorAll('.nav-selector').forEach(selector => {
                const currentValue = selector.value;
                selector.innerHTML = `<option value="">${placeholderText}</option>`;
                navItems.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.trim();
                    option.textContent = item.trim();
                    if (currentValue === item.trim()) {
                        option.selected = true;
                    }
                    selector.appendChild(option);
                });
            });

            // Add navigation selectors to sections that don't have them (except hero and layout)
            document.querySelectorAll('.section-item').forEach(section => {
                const type = section.dataset.type;
                if (type === 'layout' || type === 'hero') return;
                if (section.querySelector('.nav-selector')) return; // Already has one

                const selectorHTML = `
                    <div class="px-4 pt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">${labelText}</label>
                        <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 section-data nav-selector" data-field="assignedNavItem" onchange="updatePreview()">
                            <option value="">${placeholderText}</option>
                            ${navItems.map(item => `<option value="${item.trim()}">${item.trim()}</option>`).join('')}
                        </select>
                    </div>
                `;

                const header = section.querySelector('.bg-gray-50');
                header.insertAdjacentHTML('afterend', selectorHTML);
            });
        }

        function switchTab(event, sectionId, tab) {
            const section = document.querySelector(`[data-id="${sectionId}"]`);
            section.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active', 'text-blue-600', 'border-b-2', 'border-blue-600'));
            section.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

            event.target.classList.add('active', 'text-blue-600', 'border-b-2', 'border-blue-600');
            section.querySelector(`[data-tab="${tab}"]`).classList.remove('hidden');
        }

        function getSectionData(section) {
            const data = {};
            const style = {};

            section.querySelectorAll('.section-data').forEach(input => {
                const field = input.dataset.field;
                if (input.type === 'file' && input.dataset.imageData) {
                    data[field] = input.dataset.imageData;
                } else {
                    data[field] = input.value;
                }
            });

            section.querySelectorAll('.section-style').forEach(input => {
                style[input.dataset.style] = input.value;
            });

            return { data, style };
        }

        // Dynamic Item Management Functions
        function addDynamicItem(sectionId, itemType, template) {
            const container = document.querySelector(`#${sectionId} [data-items-container="${itemType}"]`);
            if (!container) return;

            const itemCount = container.querySelectorAll('.dynamic-item').length;
            const itemId = `${itemType}-${Date.now()}`;

            const itemHtml = template(itemId, itemCount + 1);
            const div = document.createElement('div');
            div.className = 'dynamic-item border-t pt-4 mt-4';
            div.dataset.itemId = itemId;
            div.innerHTML = itemHtml;

            container.appendChild(div);
            updatePreview();
        }

        function removeDynamicItem(button) {
            const item = button.closest('.dynamic-item');
            if (item) {
                item.remove();
                updatePreview();
            }
        }

        function updatePreview() {
            const sections = document.querySelectorAll('.section-item');
            let html = '';
            let globalStyles = {};

            // Extract global styles and layout settings from layout section
            const layoutSection = document.querySelector('[data-type="layout"]');
            let navType = 'none';
            let navItems = [];

            // Tab view settings
            let tabStyle = 'underline';
            let tabAlignment = 'left';
            let tabSize = 'medium';

            // Top navigation settings
            let navStyle = 'simple';
            let navAlignment = 'left';
            let navSize = 'medium';
            let navBgColor = '#ffffff';
            let navTextColor = '#1f2937';
            let navSticky = true;

            // Bottom navigation settings
            let bottomNavStyle = 'simple';
            let bottomNavAlignment = 'left';
            let bottomNavSize = 'medium';
            let bottomNavBgColor = '#ffffff';
            let bottomNavTextColor = '#1f2937';
            let bottomNavSticky = true;

            if (layoutSection) {
                const { data, style } = getSectionData(layoutSection);
                globalStyles = style;

                // Get navigation type
                const navTypeRadio = layoutSection.querySelector('[data-field="navType"]:checked');
                navType = navTypeRadio?.value || 'none';

                if (navType === 'tabview') {
                    const tabNamesValue = layoutSection.querySelector('[data-field="tabNames"]')?.value || '';
                    navItems = tabNamesValue.split('\n').filter(name => name.trim()).map(name => name.trim());

                    // Get tab layout style settings
                    tabStyle = layoutSection.querySelector('[data-field="tabStyle"]')?.value || 'underline';
                    tabAlignment = layoutSection.querySelector('[data-field="tabAlignment"]')?.value || 'left';
                    tabSize = layoutSection.querySelector('[data-field="tabSize"]')?.value || 'medium';
                } else if (navType === 'topnav') {
                    const navItemsValue = layoutSection.querySelector('[data-field="navItems"]')?.value || '';
                    navItems = navItemsValue.split('\n').filter(name => name.trim()).map(name => name.trim());

                    // Get top navigation style settings
                    navStyle = layoutSection.querySelector('[data-field="navStyle"]')?.value || 'simple';
                    navAlignment = layoutSection.querySelector('[data-field="navAlignment"]')?.value || 'left';
                    navSize = layoutSection.querySelector('[data-field="navSize"]')?.value || 'medium';
                    navBgColor = layoutSection.querySelector('[data-field="navBgColor"]')?.value || '#ffffff';
                    navTextColor = layoutSection.querySelector('[data-field="navTextColor"]')?.value || '#1f2937';
                    navSticky = layoutSection.querySelector('[data-field="navSticky"]')?.checked !== false;
                } else if (navType === 'bottomnav') {
                    const navItemsValue = layoutSection.querySelector('[data-field="bottomNavItems"]')?.value || '';
                    navItems = navItemsValue.split('\n').filter(name => name.trim()).map(name => name.trim());

                    // Get bottom navigation style settings
                    bottomNavStyle = layoutSection.querySelector('[data-field="bottomNavStyle"]')?.value || 'simple';
                    bottomNavAlignment = layoutSection.querySelector('[data-field="bottomNavAlignment"]')?.value || 'left';
                    bottomNavSize = layoutSection.querySelector('[data-field="bottomNavSize"]')?.value || 'medium';
                    bottomNavBgColor = layoutSection.querySelector('[data-field="bottomNavBgColor"]')?.value || '#ffffff';
                    bottomNavTextColor = layoutSection.querySelector('[data-field="bottomNavTextColor"]')?.value || '#1f2937';
                    bottomNavSticky = layoutSection.querySelector('[data-field="bottomNavSticky"]')?.checked !== false;
                }
            }

            // Apply default global styles if not set
            globalStyles = {
                primaryColor: globalStyles.primaryColor || '#9333ea',
                secondaryColor: globalStyles.secondaryColor || '#ec4899',
                bgColor: globalStyles.bgColor || '#ffffff',
                textColor: globalStyles.textColor || '#1f2937',
                fontFamily: globalStyles.fontFamily || 'system-ui, -apple-system, sans-serif',
                borderRadius: globalStyles.borderRadius || '8px',
                spacing: globalStyles.spacing || 'normal'
            };

            if (sections.length === 0 || sections.length === 1) {
                html = `
                    <div class="flex items-center justify-center h-full text-center p-8">
                        <div>
                            <div class="text-6xl mb-4">üíº</div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2">Start Creating</h3>
                            <p class="text-gray-600 text-sm">Add sections to build your business portfolio</p>
                        </div>
                    </div>
                `;
            } else if (navType === 'tabview' && navItems.length > 0) {
                // Tab View Mode
                // First, render hero section (always visible)
                const heroSection = document.querySelector('[data-type="hero"]');
                if (heroSection) {
                    const template = sectionTemplates['hero'];
                    const { data, style } = getSectionData(heroSection);
                    html += template.render(data, style, globalStyles);
                }

                // Group sections by tabs
                const sectionsByTab = {};
                navItems.forEach(tab => {
                    sectionsByTab[tab] = [];
                });

                sections.forEach(section => {
                    const type = section.dataset.type;
                    if (type === 'layout' || type === 'hero') return;

                    const assignedNavItem = section.querySelector('[data-field="assignedNavItem"]')?.value;
                    if (assignedNavItem && sectionsByTab[assignedNavItem]) {
                        const template = sectionTemplates[type];
                        const { data, style } = getSectionData(section);
                        sectionsByTab[assignedNavItem].push({
                            html: template.render(data, style, globalStyles),
                            type: type
                        });
                    }
                });

                // Generate tab navigation and content
                const tabId = 'preview-tabs-' + Date.now();

                // Define size classes
                const sizeClasses = {
                    small: 'px-4 py-2 text-xs',
                    medium: 'px-6 py-4 text-sm',
                    large: 'px-8 py-5 text-base'
                };

                // Define alignment classes
                const alignmentClasses = {
                    left: 'justify-start',
                    center: 'justify-center',
                    right: 'justify-end'
                };

                // Generate tab buttons based on style
                const generateTabButton = (tab, index, tabStyle, tabSize) => {
                    const sizeClass = sizeClasses[tabSize] || sizeClasses.medium;
                    const baseClasses = 'flex-shrink-0 font-medium transition preview-tab-btn';

                    switch(tabStyle) {
                        case 'pills':
                            return `
                                <button onclick="switchPreviewTab('${tabId}', '${tab}')"
                                        class="${baseClasses} ${sizeClass} rounded-full ${index === 0 ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}"
                                        data-tab-id="${tabId}"
                                        data-tab-name="${tab}"
                                        data-style="pills">
                                    ${tab}
                                </button>
                            `;
                        case 'buttons':
                            return `
                                <button onclick="switchPreviewTab('${tabId}', '${tab}')"
                                        class="${baseClasses} ${sizeClass} rounded-lg ${index === 0 ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'}"
                                        data-tab-id="${tabId}"
                                        data-tab-name="${tab}"
                                        data-style="buttons">
                                    ${tab}
                                </button>
                            `;
                        case 'boxed':
                            return `
                                <button onclick="switchPreviewTab('${tabId}', '${tab}')"
                                        class="${baseClasses} ${sizeClass} border-b-2 ${index === 0 ? 'bg-blue-50 border-blue-600 text-blue-600' : 'bg-white border-transparent text-gray-600 hover:bg-gray-50'}"
                                        data-tab-id="${tabId}"
                                        data-tab-name="${tab}"
                                        data-style="boxed">
                                    ${tab}
                                </button>
                            `;
                        case 'underline':
                        default:
                            return `
                                <button onclick="switchPreviewTab('${tabId}', '${tab}')"
                                        class="${baseClasses} ${sizeClass} border-b-2 ${index === 0 ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-600 hover:text-gray-900'}"
                                        data-tab-id="${tabId}"
                                        data-tab-name="${tab}"
                                        data-style="underline">
                                    ${tab}
                                </button>
                            `;
                    }
                };

                const containerClasses = tabStyle === 'pills' || tabStyle === 'buttons' ? 'gap-2' : '';
                const alignClass = alignmentClasses[tabAlignment] || alignmentClasses.left;

                html += `
                    <div class="sticky top-0 z-10 bg-white ${tabStyle !== 'pills' && tabStyle !== 'buttons' ? 'border-b' : ''} shadow-sm">
                        <div class="flex overflow-x-auto ${containerClasses} ${alignClass} p-2">
                            ${navItems.map((tab, index) => generateTabButton(tab, index, tabStyle, tabSize)).join('')}
                        </div>
                    </div>
                    <div class="preview-tab-contents" data-tab-container="${tabId}">
                        ${navItems.map((tab, index) => `
                            <div class="preview-tab-content ${index === 0 ? '' : 'hidden'}" data-tab-id="${tabId}" data-tab-name="${tab}">
                                ${sectionsByTab[tab].length > 0
                                    ? sectionsByTab[tab].map(s => s.html).join('')
                                    : `<div class="py-16 text-center text-gray-500">
                                        <div class="text-4xl mb-3">üìã</div>
                                        <p>No sections assigned to this tab yet</p>
                                       </div>`
                                }
                            </div>
                        `).join('')}
                    </div>
                `;
            } else if (navType === 'topnav' && navItems.length > 0) {
                // Top Navigation Bar Mode
                // Define size classes
                const navSizeClasses = {
                    small: 'px-3 py-2 text-xs',
                    medium: 'px-4 py-3 text-sm',
                    large: 'px-6 py-4 text-base'
                };

                // Define alignment classes
                const navAlignmentClasses = {
                    left: 'justify-start',
                    center: 'justify-center',
                    right: 'justify-end'
                };

                // Generate navigation buttons based on style
                const navId = 'preview-nav-' + Date.now();
                const generateNavButton = (item, index, navStyle, navSize) => {
                    const sizeClass = navSizeClasses[navSize] || navSizeClasses.medium;
                    const baseClasses = 'font-medium transition cursor-pointer preview-nav-btn';

                    switch(navStyle) {
                        case 'underline':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} border-b-2 ${index === 0 ? 'border-blue-600' : 'border-transparent hover:border-gray-400'}"
                                   style="color: ${navTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="underline">
                                    ${item}
                                </button>
                            `;
                        case 'pills':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} rounded-full ${index === 0 ? 'bg-blue-600 text-white' : 'hover:bg-gray-200'}"
                                   style="color: ${index === 0 ? '#ffffff' : navTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="pills">
                                    ${item}
                                </button>
                            `;
                        case 'bordered':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} rounded-lg border ${index === 0 ? 'border-blue-600 bg-blue-50' : 'border-gray-300 hover:bg-gray-50'}"
                                   style="color: ${navTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="bordered">
                                    ${item}
                                </button>
                            `;
                        case 'simple':
                        default:
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} hover:opacity-70"
                                   style="color: ${navTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="simple">
                                    ${item}
                                </button>
                            `;
                    }
                };

                const navContainerClasses = navStyle === 'pills' || navStyle === 'bordered' ? 'gap-2' : 'gap-6';
                const navAlignClass = navAlignmentClasses[navAlignment] || navAlignmentClasses.left;
                const stickyClass = navSticky ? 'sticky top-0 z-10' : '';

                // Render top navigation bar FIRST
                html += `
                    <div class="${stickyClass} shadow-sm" style="background-color: ${navBgColor}; border-bottom: 1px solid #e5e7eb;">
                        <div class="flex overflow-x-auto ${navContainerClasses} ${navAlignClass} px-4 py-3">
                            ${navItems.map((item, index) => generateNavButton(item, index, navStyle, navSize)).join('')}
                        </div>
                    </div>
                `;

                // Then render hero section (always visible, not in navigation sections)
                const heroSection = document.querySelector('[data-type="hero"]');
                if (heroSection) {
                    const template = sectionTemplates['hero'];
                    const { data, style } = getSectionData(heroSection);
                    html += template.render(data, style, globalStyles);
                }

                // Group sections by navigation items
                const sectionsByNavItem = {};
                navItems.forEach(item => {
                    sectionsByNavItem[item] = [];
                });

                sections.forEach(section => {
                    const type = section.dataset.type;
                    if (type === 'layout' || type === 'hero') return;

                    const assignedNavItem = section.querySelector('[data-field="assignedNavItem"]')?.value;
                    if (assignedNavItem && sectionsByNavItem[assignedNavItem]) {
                        const template = sectionTemplates[type];
                        const { data, style } = getSectionData(section);
                        sectionsByNavItem[assignedNavItem].push({
                            html: template.render(data, style, globalStyles),
                            type: type
                        });
                    }
                });

                // Render navigation sections (only first one visible)
                html += `
                    <div class="nav-sections-container" data-nav-container="${navId}">
                        ${navItems.map((item, index) => {
                            return `
                                <div class="nav-section-content ${index === 0 ? '' : 'hidden'}" data-nav-id="${navId}" data-nav-item="${item}">
                                    ${sectionsByNavItem[item].length > 0
                                        ? sectionsByNavItem[item].map(s => s.html).join('')
                                        : `<div class="py-16 text-center text-gray-500">
                                            <div class="text-4xl mb-3">üìã</div>
                                            <p>No sections assigned to "${item}" yet</p>
                                           </div>`
                                    }
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            } else if (navType === 'bottomnav' && navItems.length > 0) {
                // Bottom Navigation Bar Mode
                const navId = 'preview-nav-' + Date.now();

                // Wrap everything in a flex container for sticky bottom nav
                html += '<div class="min-h-full flex flex-col">';

                // First, render hero section (always visible)
                const heroSection = document.querySelector('[data-type="hero"]');
                if (heroSection) {
                    const template = sectionTemplates['hero'];
                    const { data, style } = getSectionData(heroSection);
                    html += template.render(data, style, globalStyles);
                }

                // Group sections by navigation items
                const sectionsByNavItem = {};
                navItems.forEach(item => {
                    sectionsByNavItem[item] = [];
                });

                sections.forEach(section => {
                    const type = section.dataset.type;
                    if (type === 'layout' || type === 'hero') return;

                    const assignedNavItem = section.querySelector('[data-field="assignedNavItem"]')?.value;
                    if (assignedNavItem && sectionsByNavItem[assignedNavItem]) {
                        const template = sectionTemplates[type];
                        const { data, style } = getSectionData(section);
                        sectionsByNavItem[assignedNavItem].push({
                            html: template.render(data, style, globalStyles),
                            type: type
                        });
                    }
                });

                // Render navigation sections (only first one visible)
                html += `
                    <div class="flex-1 nav-sections-container" data-nav-container="${navId}">
                        ${navItems.map((item, index) => {
                            return `
                                <div class="nav-section-content ${index === 0 ? '' : 'hidden'}" data-nav-id="${navId}" data-nav-item="${item}">
                                    ${sectionsByNavItem[item].length > 0
                                        ? sectionsByNavItem[item].map(s => s.html).join('')
                                        : `<div class="py-16 text-center text-gray-500">
                                            <div class="text-4xl mb-3">üìã</div>
                                            <p>No sections assigned to "${item}" yet</p>
                                           </div>`
                                    }
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;

                // Define size classes
                const navSizeClasses = {
                    small: 'px-3 py-2 text-xs',
                    medium: 'px-4 py-3 text-sm',
                    large: 'px-6 py-4 text-base'
                };

                // Define alignment classes
                const navAlignmentClasses = {
                    left: 'justify-start',
                    center: 'justify-center',
                    right: 'justify-end'
                };

                // Generate navigation buttons based on style
                const generateNavButton = (item, index, navStyle, navSize) => {
                    const sizeClass = navSizeClasses[navSize] || navSizeClasses.medium;
                    const baseClasses = 'font-medium transition cursor-pointer preview-nav-btn';

                    switch(navStyle) {
                        case 'underline':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} border-t-2 ${index === 0 ? 'border-blue-600' : 'border-transparent hover:border-gray-400'}"
                                   style="color: ${bottomNavTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="underline">
                                    ${item}
                                </button>
                            `;
                        case 'pills':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} rounded-full ${index === 0 ? 'bg-blue-600 text-white' : 'hover:bg-gray-200'}"
                                   style="color: ${index === 0 ? '#ffffff' : bottomNavTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="pills">
                                    ${item}
                                </button>
                            `;
                        case 'bordered':
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} rounded-lg border ${index === 0 ? 'border-blue-600 bg-blue-50' : 'border-gray-300 hover:bg-gray-50'}"
                                   style="color: ${bottomNavTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="bordered">
                                    ${item}
                                </button>
                            `;
                        case 'simple':
                        default:
                            return `
                                <button onclick="switchNavSection('${navId}', '${item}')"
                                   class="${baseClasses} ${sizeClass} hover:opacity-70"
                                   style="color: ${bottomNavTextColor};"
                                   data-nav-id="${navId}"
                                   data-nav-item="${item}"
                                   data-style="simple">
                                    ${item}
                                </button>
                            `;
                    }
                };

                const navContainerClasses = bottomNavStyle === 'pills' || bottomNavStyle === 'bordered' ? 'gap-2' : 'gap-6';
                const navAlignClass = navAlignmentClasses[bottomNavAlignment] || navAlignmentClasses.left;
                const stickyClass = bottomNavSticky ? 'sticky bottom-0 z-10' : '';

                // Render bottom navigation bar LAST
                html += `
                    <div class="${stickyClass} shadow-sm mt-auto" style="background-color: ${bottomNavBgColor}; border-top: 1px solid #e5e7eb;">
                        <div class="flex overflow-x-auto ${navContainerClasses} ${navAlignClass} px-4 py-3">
                            ${navItems.map((item, index) => generateNavButton(item, index, bottomNavStyle, bottomNavSize)).join('')}
                        </div>
                    </div>
                </div>`; // Close the flex container
            } else {
                // Normal Mode (no navigation)
                sections.forEach(section => {
                    const type = section.dataset.type;
                    if (type === 'layout') return;
                    const template = sectionTemplates[type];
                    const { data, style } = getSectionData(section);
                    html += template.render(data, style, globalStyles);
                });
            }

            // Wrap content with global styles
            const styledHtml = `
                <div style="font-family: ${globalStyles.fontFamily}; color: ${globalStyles.textColor}; background: ${globalStyles.bgColor};">
                    ${html}
                </div>
            `;

            document.getElementById('previewContent').innerHTML = styledHtml;

            // Also update mobile preview if it's open
            const mobilePreview = document.getElementById('mobilePreviewContent');
            if (mobilePreview && !document.getElementById('mobilePreviewModal').classList.contains('hidden')) {
                mobilePreview.innerHTML = styledHtml;
            }
        }

        function switchPreviewTab(containerId, tabName) {
            // Update button states based on tab style
            document.querySelectorAll(`[data-tab-id="${containerId}"]`).forEach(btn => {
                if (btn.classList.contains('preview-tab-btn')) {
                    const isActive = btn.dataset.tabName === tabName;
                    const style = btn.dataset.style;

                    // Remove all active state classes
                    btn.classList.remove(
                        'border-blue-600', 'text-blue-600', 'border-transparent', 'text-gray-600',
                        'bg-blue-600', 'text-white', 'bg-gray-200', 'text-gray-700',
                        'bg-blue-50', 'bg-white', 'text-gray-700', 'border-gray-300'
                    );

                    // Apply appropriate classes based on style and active state
                    switch(style) {
                        case 'pills':
                            if (isActive) {
                                btn.classList.add('bg-blue-600', 'text-white');
                            } else {
                                btn.classList.add('bg-gray-200', 'text-gray-700');
                            }
                            break;
                        case 'buttons':
                            if (isActive) {
                                btn.classList.add('bg-blue-600', 'text-white');
                            } else {
                                btn.classList.add('bg-white', 'text-gray-700', 'border', 'border-gray-300');
                            }
                            break;
                        case 'boxed':
                            if (isActive) {
                                btn.classList.add('bg-blue-50', 'border-blue-600', 'text-blue-600');
                            } else {
                                btn.classList.add('bg-white', 'border-transparent', 'text-gray-600');
                            }
                            break;
                        case 'underline':
                        default:
                            if (isActive) {
                                btn.classList.add('border-blue-600', 'text-blue-600');
                            } else {
                                btn.classList.add('border-transparent', 'text-gray-600');
                            }
                            break;
                    }
                }
            });

            // Update content visibility
            document.querySelectorAll(`[data-tab-container="${containerId}"] .preview-tab-content`).forEach(content => {
                if (content.dataset.tabName === tabName) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
        }

        function switchNavSection(navId, itemName) {
            // Update button states based on navigation style
            document.querySelectorAll(`[data-nav-id="${navId}"]`).forEach(btn => {
                if (btn.classList.contains('preview-nav-btn')) {
                    const isActive = btn.dataset.navItem === itemName;
                    const style = btn.dataset.style;
                    const currentColor = btn.style.color;

                    // Remove all active state classes
                    btn.classList.remove(
                        'border-blue-600', 'border-transparent',
                        'bg-blue-600', 'text-white', 'hover:bg-gray-200',
                        'bg-blue-50', 'border-gray-300', 'hover:bg-gray-50'
                    );

                    // Apply appropriate classes based on style and active state
                    switch(style) {
                        case 'underline':
                            if (isActive) {
                                btn.classList.add('border-blue-600');
                            } else {
                                btn.classList.add('border-transparent', 'hover:border-gray-400');
                            }
                            break;
                        case 'pills':
                            if (isActive) {
                                btn.classList.add('bg-blue-600', 'text-white');
                                btn.style.color = '#ffffff';
                            } else {
                                btn.classList.add('hover:bg-gray-200');
                                btn.style.color = currentColor;
                            }
                            break;
                        case 'bordered':
                            if (isActive) {
                                btn.classList.add('border-blue-600', 'bg-blue-50');
                            } else {
                                btn.classList.add('border-gray-300', 'hover:bg-gray-50');
                            }
                            break;
                        case 'simple':
                        default:
                            // Simple style doesn't change appearance on active
                            break;
                    }
                }
            });

            // Update content visibility
            document.querySelectorAll(`[data-nav-container="${navId}"] .nav-section-content`).forEach(content => {
                if (content.dataset.navItem === itemName) {
                    content.classList.remove('hidden');
                } else {
                    content.classList.add('hidden');
                }
            });
        }

        function handleImageUpload(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    input.dataset.imageData = e.target.result;
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }

        function setDevice(device) {
            document.querySelectorAll('.device-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-blue-600', 'text-white');
            });
            event.target.classList.add('active', 'bg-blue-600', 'text-white');

            const frame = document.getElementById('mobileFrame');
            if (device === 'tablet') {
                frame.style.width = '768px';
                frame.style.height = '1024px';
            } else {
                frame.style.width = '375px';
                frame.style.height = '667px';
            }
        }

        function previewFullscreen() {
            window.open('', '_blank');
            alert('Full screen preview would open here');
        }

        function generateQR() {
            document.getElementById('qrModal').classList.remove('hidden');
        }

        function closeQRModal() {
            document.getElementById('qrModal').classList.add('hidden');
        }

        function copyUrl() {
            const url = document.getElementById('shareUrl').textContent;
            navigator.clipboard.writeText(url).then(() => {
                alert('URL copied to clipboard!');
            });
        }

        function publishProject() {
            if (confirm('Publish your business portfolio?')) {
                alert('‚úÖ Published successfully!\n\nYour portfolio is now live!');
            }
        }

        function openMobilePreview() {
            // Copy preview content to mobile preview modal
            const previewContent = document.getElementById('previewContent').innerHTML;
            document.getElementById('mobilePreviewContent').innerHTML = previewContent;

            // Show the modal
            document.getElementById('mobilePreviewModal').classList.remove('hidden');
        }

        function closeMobilePreview() {
            document.getElementById('mobilePreviewModal').classList.add('hidden');
        }

        function setMobilePreviewDevice(device) {
            // Update active button
            document.querySelectorAll('.mobile-preview-device-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-blue-600', 'text-white');
            });
            event.target.classList.add('active', 'bg-blue-600', 'text-white');

            // Update frame size
            const frame = document.getElementById('mobilePreviewFrame');
            if (device === 'tablet') {
                frame.style.width = '768px';
                frame.style.height = '1024px';
            } else {
                frame.style.width = '375px';
                frame.style.height = '667px';
            }
        }

        // Initialize layout section on page load
        function initializeLayout() {
            addSection('layout');
        }

        // Initialize with default sections on page load
        function initializeDefaultSections() {
            // Add default sections here based on template type
            const defaultSections = ['hero', 'about', 'services', 'contact'];
            defaultSections.forEach(sectionType => addSection(sectionType));
        }

        // Load everything when DOM is ready
        window.addEventListener('DOMContentLoaded', () => {
            // Initialize layout first
            initializeLayout();

            // Then add default sections
            initializeDefaultSections();

            // Close modals on outside click
            document.getElementById('sectionModal').addEventListener('click', (e) => {
                if (e.target.id === 'sectionModal') closeSectionModal();
            });
            document.getElementById('qrModal').addEventListener('click', (e) => {
                if (e.target.id === 'qrModal') closeQRModal();
            });
            document.getElementById('mobilePreviewModal').addEventListener('click', (e) => {
                if (e.target.id === 'mobilePreviewModal') closeMobilePreview();
            });
        });
    </script>
</body>
</html>
